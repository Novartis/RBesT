<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Decision Function for 1 Sample Designs — decision1S • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Decision Function for 1 Sample Designs — decision1S"><meta name="description" content="The function sets up a 1 sample one-sided decision function with an
arbitrary number of conditions."><meta property="og:description" content="The function sets up a 1 sample one-sided decision function with an
arbitrary number of conditions."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Decision Function for 1 Sample Designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/R/decision1S.R" class="external-link"><code>R/decision1S.R</code></a></small>
      <div class="d-none name"><code>decision1S.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function sets up a 1 sample one-sided decision function with an
arbitrary number of conditions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decision1S</span><span class="op">(</span>pc <span class="op">=</span> <span class="fl">0.975</span>, qc <span class="op">=</span> <span class="fl">0</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oc1Sdecision</span><span class="op">(</span>pc <span class="op">=</span> <span class="fl">0.975</span>, qc <span class="op">=</span> <span class="fl">0</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pc">pc<a class="anchor" aria-label="anchor" href="#arg-pc"></a></dt>
<dd><p>Vector of critical cumulative probabilities.</p></dd>


<dt id="arg-qc">qc<a class="anchor" aria-label="anchor" href="#arg-qc"></a></dt>
<dd><p>Vector of respective critical values. Must match the length of <code>pc</code>.</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), probabilities
are \(P(X \leq x)\), otherwise, \(P(X &gt; x)\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a decision function which takes two
arguments. The first argument is expected to be a mixture
(posterior) distribution which is tested if the specified
conditions are met. The logical second argument determines if the
function acts as an indicator function or if the function returns
the distance from the decision boundary for each condition in
log-space, i.e. the distance is 0 at the decision boundary,
negative for a 0 decision and positive for a 1 decision.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function creates a one-sided decision function which
takes two arguments. The first argument is expected to be a mixture
(posterior) distribution. This distribution is tested whether it
fulfills all the required threshold conditions specified with the
<code>pc</code> and <code>qc</code> arguments and returns 1 if all conditions
are met and 0 otherwise. Hence, for <code>lower.tail=TRUE</code>
condition \(i\) is equivalent to</p>
<p>$$P(\theta \leq q_{c,i}) &gt; p_{c,i}$$</p>
<p>and the decision function is implemented as indicator function on
the basis of the heavy-side step function \(H(x)\) which is \(0\)
for \(x \leq 0\) and \(1\) for \(x &gt; 0\). As all conditions
must be met, the final indicator function returns</p>
<p>$$\Pi_i H_i(P(\theta \leq q_{c,i}) - p_{c,i} ).$$</p>
<p>When the second argument is set to <code>TRUE</code> a distance metric is
returned component-wise per defined condition as</p>
<p>$$ D_i = \log(P(\theta &lt; q_{c,i})) - \log(p_{c,i}) .$$</p>
<p>These indicator functions can be used as input for 1-sample
boundary, OC or PoS calculations using <code><a href="oc1S.html">oc1S()</a></code> or
<code><a href="pos1S.html">pos1S()</a></code> .</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>oc1Sdecision()</code>: Deprecated old function name. Please use
<code>decision1S</code> instead.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Neuenschwander B, Rouyrre N, Hollaender H, Zuber E,
Branson M. A proof of concept phase II non-inferiority
criterion. <em>Stat. in Med.</em>. 2011, 30:1618-1627</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other design1S:
<code><a href="decision1S_boundary.html">decision1S_boundary</a>()</code>,
<code><a href="oc1S.html">oc1S</a>()</code>,
<code><a href="pos1S.html">pos1S</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see Neuenschwander et al., 2011</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example is for a time-to-event trial evaluating non-inferiority</span></span></span>
<span class="r-in"><span><span class="co"># using a normal approximation for the log-hazard ratio</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># reference scale</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">theta_ni</span> <span class="op">&lt;-</span> <span class="fl">0.4</span></span></span>
<span class="r-in"><span><span class="va">theta_a</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span></span>
<span class="r-in"><span><span class="va">za</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">s</span> <span class="op">*</span> <span class="op">(</span><span class="va">za</span> <span class="op">+</span> <span class="va">zb</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">theta_ni</span> <span class="op">-</span> <span class="va">theta_a</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># n for which design was intended</span></span></span>
<span class="r-in"><span><span class="va">nL</span> <span class="op">&lt;-</span> <span class="fl">233</span></span></span>
<span class="r-in"><span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="va">theta_ni</span> <span class="op">-</span> <span class="va">za</span> <span class="op">*</span> <span class="va">s</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># flat prior</span></span></span>
<span class="r-in"><span><span class="va">flat_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># standard NI design</span></span></span>
<span class="r-in"><span><span class="va">decA</span> <span class="op">&lt;-</span> <span class="fu">decision1S</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, <span class="va">theta_ni</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for double criterion with indecision point (mean estimate must be</span></span></span>
<span class="r-in"><span><span class="co"># lower than this)</span></span></span>
<span class="r-in"><span><span class="va">theta_c</span> <span class="op">&lt;-</span> <span class="va">c1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># double criterion design</span></span></span>
<span class="r-in"><span><span class="co"># statistical significance (like NI design)</span></span></span>
<span class="r-in"><span><span class="va">dec1</span> <span class="op">&lt;-</span> <span class="fu">decision1S</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, <span class="va">theta_ni</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># require mean to be at least as good as theta_c</span></span></span>
<span class="r-in"><span><span class="va">dec2</span> <span class="op">&lt;-</span> <span class="fu">decision1S</span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">theta_c</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># combination</span></span></span>
<span class="r-in"><span><span class="va">decComb</span> <span class="op">&lt;-</span> <span class="fu">decision1S</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta_ni</span>, <span class="va">theta_c</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta_eval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">theta_a</span>, <span class="va">theta_c</span>, <span class="va">theta_ni</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we can display the decision function definition</span></span></span>
<span class="r-in"><span><span class="va">decComb</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 sample decision function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditions for acceptance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(theta &lt;= 0.4) &gt; 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(theta &lt;= 0.13576435472344) &gt; 0.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># and use it to decide if a given distribution fulfills all</span></span></span>
<span class="r-in"><span><span class="co"># criterions defined</span></span></span>
<span class="r-in"><span><span class="co"># for the prior</span></span></span>
<span class="r-in"><span><span class="fu">decComb</span><span class="op">(</span><span class="va">flat_prior</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span><span class="co"># or for a possible outcome of the trial</span></span></span>
<span class="r-in"><span><span class="co"># here with HR of 0.8 for 40 events</span></span></span>
<span class="r-in"><span><span class="fu">decComb</span><span class="op">(</span><span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">flat_prior</span>, m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.8</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

