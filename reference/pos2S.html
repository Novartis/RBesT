<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Probability of Success for 2 Sample Design — pos2S • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Probability of Success for 2 Sample Design — pos2S"><meta name="description" content="The pos2S function defines a 2 sample design (priors, sample
sizes &amp;amp; decision function) for the calculation of the probability
of success. A function is returned which calculates the calculates
the frequency at which the decision function is evaluated to 1 when
parameters are distributed according to the given distributions."><meta property="og:description" content="The pos2S function defines a 2 sample design (priors, sample
sizes &amp;amp; decision function) for the calculation of the probability
of success. A function is returned which calculates the calculates
the frequency at which the decision function is evaluated to 1 when
parameters are distributed according to the given distributions."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Probability of Success for 2 Sample Design</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/R/pos2S.R" class="external-link"><code>R/pos2S.R</code></a></small>
      <div class="d-none name"><code>pos2S.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>pos2S</code> function defines a 2 sample design (priors, sample
sizes &amp; decision function) for the calculation of the probability
of success. A function is returned which calculates the calculates
the frequency at which the decision function is evaluated to 1 when
parameters are distributed according to the given distributions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pos2S</span><span class="op">(</span><span class="va">prior1</span>, <span class="va">prior2</span>, <span class="va">n1</span>, <span class="va">n2</span>, <span class="va">decision</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'betaMix'</span></span>
<span><span class="fu">pos2S</span><span class="op">(</span><span class="va">prior1</span>, <span class="va">prior2</span>, <span class="va">n1</span>, <span class="va">n2</span>, <span class="va">decision</span>, <span class="va">eps</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'normMix'</span></span>
<span><span class="fu">pos2S</span><span class="op">(</span></span>
<span>  <span class="va">prior1</span>,</span>
<span>  <span class="va">prior2</span>,</span>
<span>  <span class="va">n1</span>,</span>
<span>  <span class="va">n2</span>,</span>
<span>  <span class="va">decision</span>,</span>
<span>  <span class="va">sigma1</span>,</span>
<span>  <span class="va">sigma2</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  Ngrid <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gammaMix'</span></span>
<span><span class="fu">pos2S</span><span class="op">(</span><span class="va">prior1</span>, <span class="va">prior2</span>, <span class="va">n1</span>, <span class="va">n2</span>, <span class="va">decision</span>, eps <span class="op">=</span> <span class="fl">1e-06</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-prior-">prior1<a class="anchor" aria-label="anchor" href="#arg-prior-"></a></dt>
<dd><p>Prior for sample 1.</p></dd>


<dt id="arg-prior-">prior2<a class="anchor" aria-label="anchor" href="#arg-prior-"></a></dt>
<dd><p>Prior for sample 2.</p></dd>


<dt id="arg-n-n-">n1, n2<a class="anchor" aria-label="anchor" href="#arg-n-n-"></a></dt>
<dd><p>Sample size of the respective samples. Sample size <code>n1</code> must be greater than 0 while sample size <code>n2</code> must be greater or equal to 0.</p></dd>


<dt id="arg-decision">decision<a class="anchor" aria-label="anchor" href="#arg-decision"></a></dt>
<dd><p>Two-sample decision function to use; see <code><a href="decision2S.html">decision2S</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Support of random variables are determined as the
interval covering <code>1-eps</code> probability mass. Defaults to
\(10^{-6}\).</p></dd>


<dt id="arg-sigma-">sigma1<a class="anchor" aria-label="anchor" href="#arg-sigma-"></a></dt>
<dd><p>The fixed reference scale of sample 1. If left
unspecified, the default reference scale of the prior 1 is assumed.</p></dd>


<dt id="arg-sigma-">sigma2<a class="anchor" aria-label="anchor" href="#arg-sigma-"></a></dt>
<dd><p>The fixed reference scale of sample 2. If left
unspecified, the default reference scale of the prior 2 is assumed.</p></dd>


<dt id="arg-ngrid">Ngrid<a class="anchor" aria-label="anchor" href="#arg-ngrid"></a></dt>
<dd><p>Determines density of discretization grid on which
decision function is evaluated (see below for more details).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a function which when called with two arguments
<code>mix1</code> and <code>mix2</code> will return the frequencies at
which the decision function is evaluated to 1. Each argument is
expected to be a mixture distribution representing the assumed true
distribution of the parameter in each group.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>pos2S</code> function defines a 2 sample design and
returns a function which calculates its probability of success.
The probability of success is the frequency with which the decision
function is evaluated to 1 under the assumption of a given true
distribution of the data implied by a distirbution of the
parameters \(\theta_1\) and \(\theta_2\).</p>
<p>The calculation is analogous to the operating characeristics
<code><a href="oc2S.html">oc2S()</a></code> with the difference that instead of assuming
known (point-wise) true parameter values a distribution is
specified for each parameter.</p>
<p>Calling the <code>pos2S</code> function calculates the decision boundary
\(D_1(y_2)\) and returns a function which can be used to evaluate the
PoS for different predictive distributions. It is evaluated as</p>
<p>$$ \int\int\int f_2(y_2|\theta_2) \, p(\theta_2) \, F_1(D_1(y_2)|\theta_1) \, p(\theta_1) \, dy_2 d\theta_2 d\theta_1. $$</p>
<p>where \(F\) is the distribution function of the sampling
distribution and \(p(\theta_1)\) and \(p(\theta_2)\) specifies
the assumed true distribution of the parameters \(\theta_1\) and
\(\theta_2\), respectively. Each distribution \(p(\theta_1)\)
and \(p(\theta_2)\) is a mixture distribution and given as the
<code>mix1</code> and <code>mix2</code> argument to the function.</p>
<p>For example, in the binary case an integration of the predictive
distribution, the BetaBinomial, instead of the binomial
distribution will be performed over the data space wherever the
decision function is evaluated to 1. All other aspects of the
calculation are as for the 2-sample operating characteristics, see
<code><a href="oc2S.html">oc2S()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>

<ul><li><p><code>pos2S(betaMix)</code>: Applies for binomial model with a mixture
beta prior. The calculations use exact expressions.  If the
optional argument <code>eps</code> is defined, then an approximate method
is used which limits the search for the decision boundary to the
region of <code>1-eps</code> probability mass. This is useful for designs
with large sample sizes where an exact approach is very costly to
calculate.</p></li>
<li><p><code>pos2S(normMix)</code>: Applies for the normal model with known
standard deviation \(\sigma\) and normal mixture priors for the
means. As a consequence from the assumption of a known standard
deviation, the calculation discards sampling uncertainty of the
second moment. The function has two extra arguments (with
defaults): <code>eps</code> (\(10^{-6}\)) and <code>Ngrid</code> (10). The
decision boundary is searched in the region of probability mass
<code>1-eps</code>, respectively for \(y_1\) and \(y_2\). The
continuous decision function is evaluated at a discrete grid, which
is determined by a spacing with \(\delta_2 =
\sigma_2/\sqrt{N_{grid}}\). Once the decision boundary is evaluated
at the discrete steps, a spline is used to inter-polate the
decision boundary at intermediate points.</p></li>
<li><p><code>pos2S(gammaMix)</code>: Applies for the Poisson model with a gamma
mixture prior for the rate parameter.  The function
<code>pos2S</code> takes an extra argument <code>eps</code> (defaults to \(10^{-6}\)) which
determines the region of probability mass <code>1-eps</code> where the
boundary is searched for \(y_1\) and \(y_2\), respectively.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other design2S:
<code><a href="decision2S.html">decision2S</a>()</code>,
<code><a href="decision2S_boundary.html">decision2S_boundary</a>()</code>,
<code><a href="oc2S.html">oc2S</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see ?decision2S for details of example</span></span></span>
<span class="r-in"><span><span class="va">priorT</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.001</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">88</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">priorP</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">49</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">88</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the success criteria is for delta which are larger than some</span></span></span>
<span class="r-in"><span><span class="co"># threshold value which is why we set lower.tail=FALSE</span></span></span>
<span class="r-in"><span><span class="va">successCrit</span> <span class="op">&lt;-</span> <span class="fu"><a href="decision2S.html">decision2S</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example interim outcome</span></span></span>
<span class="r-in"><span><span class="va">postP_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">priorP</span>, n <span class="op">=</span> <span class="fl">10</span>, m <span class="op">=</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 88</span>
<span class="r-in"><span><span class="va">postT_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">priorT</span>, n <span class="op">=</span> <span class="fl">20</span>, m <span class="op">=</span> <span class="op">-</span><span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 88</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># assume that mean -50 / -80 were observed at the interim for</span></span></span>
<span class="r-in"><span><span class="co"># placebo control(n=10) / active treatment(n=20) which gives</span></span></span>
<span class="r-in"><span><span class="co"># the posteriors</span></span></span>
<span class="r-in"><span><span class="va">postP_interim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate normal mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference scale: 88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   comp1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w   1.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m -49.33333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s  16.06653</span>
<span class="r-in"><span><span class="va">postT_interim</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Univariate normal mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference scale: 88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   comp1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w   1.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m -79.99600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s  19.67691</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># then the PoS to succeed after another 20/30 patients is</span></span></span>
<span class="r-in"><span><span class="va">pos_final</span> <span class="op">&lt;-</span> <span class="fu">pos2S</span><span class="op">(</span><span class="va">postP_interim</span>, <span class="va">postT_interim</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="va">successCrit</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior 1 reference scale 88</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior 2 reference scale 88</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">pos_final</span><span class="op">(</span><span class="va">postP_interim</span>, <span class="va">postT_interim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.145567</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

