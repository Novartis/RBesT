<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multivariate Normal Mixture Density — mixmvnorm • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate Normal Mixture Density — mixmvnorm"><meta name="description" content="The multivariate normal mixture density and auxiliary
functions."><meta property="og:description" content="The multivariate normal mixture density and auxiliary
functions."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multivariate Normal Mixture Density</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/R/mixmvnorm.R" class="external-link"><code>R/mixmvnorm.R</code></a></small>
      <div class="d-none name"><code>mixmvnorm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The multivariate normal mixture density and auxiliary
functions.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mixmvnorm</span><span class="op">(</span><span class="va">...</span>, <span class="va">sigma</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ms"</span>, <span class="st">"mn"</span>, <span class="st">"msr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">msr2mvnorm</span><span class="op">(</span><span class="va">m</span>, <span class="va">s</span>, <span class="va">r</span>, unlist <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvnormMix'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvnormMix'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mvnormMix'</span></span>
<span><span class="fu"><a href="mixnorm.html">sigma</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>List of mixture components.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Reference covariance.</p></dd>


<dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>Determines how the parameters in the list are
interpreted. See details.</p></dd>


<dt id="arg-m">m<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Mean vector.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>Standard deviation vector.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Vector of correlations in column-major format of the lower
triangle of the correlation matrix.</p></dd>


<dt id="arg-unlist">unlist<a class="anchor" aria-label="anchor" href="#arg-unlist"></a></dt>
<dd><p>Logical. Controls whether the result is a flattened
vector (<code>TRUE</code>) or a list with mean <code>m</code> and covariance <code>s</code>
(<code>FALSE</code>). Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-object-x">object, x<a class="anchor" aria-label="anchor" href="#arg-object-x"></a></dt>
<dd><p>Multivariate normal mixture object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a multivariate normal mixture with the specified
mixture components.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each entry in the <code>...</code> argument list is a numeric
vector defining one component of the mixture multivariate
normal distribution. The first entry of the component defining
vector is the weight of the mixture component followed by the
vector of means in each dimension and finally a specification
of the covariance matrix, which depends on the chosen
parametrization. The covariance matrix is expected to be given
as numeric vector in a column-major format, which is standard
conversion applied to matrices by the vector concatenation
function <code><a href="https://rdrr.io/r/base/c.html" class="external-link">base::c()</a></code>. Please refer to the examples
section below.</p>
<p>Each component defining vector can be specified in different ways
as determined by the <code>param</code> option:</p>
<dl><dt>ms</dt>
<dd><p>Mean vector and covariance matrix <code>s</code>. Default.</p></dd>

<dt>mn</dt>
<dd><p>Mean vector and number of observations. <code>n</code> determines
the covariance for each component via the relation \(\Sigma/n\)
with \(\Sigma\) being the known reference covariance.</p></dd>

<dt>msr</dt>
<dd><p>Mean vector, standard deviations and correlations in
column-major format (corresponds to order when printing multi-variate
normal mixtures).</p></dd>


</dl><p>The reference covariance \(\Sigma\) is the known covariance in
the normal-normal model (observation covariance). The function
<code>sigma</code> can be used to query the reference covariance and may
also be used to assign a new reference covariance, see examples
below. In case <code>sigma</code> is not specified, the user has to
supply <code>sigma</code> as argument to functions which require a
reference covariance.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other mixdist:
<code><a href="mix.html">mix</a></code>,
<code><a href="mixbeta.html">mixbeta</a>()</code>,
<code><a href="mixcombine.html">mixcombine</a>()</code>,
<code><a href="mixgamma.html">mixgamma</a>()</code>,
<code><a href="mixjson.html">mixjson</a></code>,
<code><a href="mixnorm.html">mixnorm</a>()</code>,
<code><a href="mixplot.html">mixplot</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default mean &amp; covariance parametrization</span></span></span>
<span class="r-in"><span><span class="va">S</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mvnm1</span> <span class="op">&lt;-</span> <span class="fu">mixmvnorm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">S</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">S</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mvnm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate normal mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome dimension: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference covariance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          rob inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w        0.2 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m[1]     0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m[2]     0.0 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]     2.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]     2.0 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho[2,1] 0.0 0.5</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mvnm1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $mean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1   2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.4 0.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cov</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1    2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1.04 0.28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.28 1.76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">657846</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mixSamp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mix.html">rmix</a></span><span class="op">(</span><span class="va">mvnm1</span>, <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">mixSamp1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         1         2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.3709829 0.8039847 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># alternative mean, sd and correlation parametrization</span></span></span>
<span class="r-in"><span><span class="va">mvnm1_alt</span> <span class="op">&lt;-</span> <span class="fu">mixmvnorm</span><span class="op">(</span></span></span>
<span class="r-in"><span>  rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">0.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sigma <span class="op">=</span> <span class="fu">msr2mvnorm</span><span class="op">(</span>s <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">0.5</span>, unlist <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">s</span>,</span></span>
<span class="r-in"><span>  param <span class="op">=</span> <span class="st">"msr"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mvnm1_alt</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Multivariate normal mixture</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Outcome dimension: 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Reference covariance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 1 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mixture Components:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          rob inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> w        0.2 0.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m[1]     0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> m[2]     0.0 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[1]     2.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> s[2]     2.0 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> rho[2,1] 0.0 0.5</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

