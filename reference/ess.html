<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Effective Sample Size for a Conjugate Prior — ess • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Effective Sample Size for a Conjugate Prior — ess"><meta name="description" content="Calculates the Effective Sample Size (ESS) for a mixture prior. The
ESS indicates how many experimental units the prior is roughly
equivalent to."><meta property="og:description" content="Calculates the Effective Sample Size (ESS) for a mixture prior. The
ESS indicates how many experimental units the prior is roughly
equivalent to."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Effective Sample Size for a Conjugate Prior</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/R/mixess.R" class="external-link"><code>R/mixess.R</code></a></small>
      <div class="d-none name"><code>ess.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates the Effective Sample Size (ESS) for a mixture prior. The
ESS indicates how many experimental units the prior is roughly
equivalent to.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ess</span><span class="op">(</span><span class="va">mix</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elir"</span>, <span class="st">"moment"</span>, <span class="st">"morita"</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'betaMix'</span></span>
<span><span class="fu">ess</span><span class="op">(</span><span class="va">mix</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elir"</span>, <span class="st">"moment"</span>, <span class="st">"morita"</span><span class="op">)</span>, <span class="va">...</span>, s <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'gammaMix'</span></span>
<span><span class="fu">ess</span><span class="op">(</span><span class="va">mix</span>, method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elir"</span>, <span class="st">"moment"</span>, <span class="st">"morita"</span><span class="op">)</span>, <span class="va">...</span>, s <span class="op">=</span> <span class="fl">100</span>, eps <span class="op">=</span> <span class="fl">1e-04</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'normMix'</span></span>
<span><span class="fu">ess</span><span class="op">(</span></span>
<span>  <span class="va">mix</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"elir"</span>, <span class="st">"moment"</span>, <span class="st">"morita"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  <span class="va">sigma</span>,</span>
<span>  s <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mix">mix<a class="anchor" aria-label="anchor" href="#arg-mix"></a></dt>
<dd><p>Prior (mixture of conjugate distributions).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Selects the used method. Can be either <code>elir</code>
(default), <code>moment</code> or <code>morita</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Optional arguments applicable to specific methods.</p></dd>


<dt id="arg-s">s<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p>For <code>morita</code> method large constant to ensure that the
prior scaled by this value is vague (default 100); see Morita
et al. (2008) for details.</p></dd>


<dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Probability mass left out from the numerical integration
of the expected information for the Poisson-Gamma case of
Morita method (defaults to 1E-4).</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>defines data likelihood and link function
(<code>binomial</code>, <code>gaussian</code>, or <code>poisson</code>).</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>reference scale.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns the ESS of the prior as floating point number.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The ESS is calculated using either the expected local
information ratio (elir) <em>Neuenschwander et
al. (2020)</em>, the moments approach or the method by
<em>Morita et al. (2008)</em>.</p>
<p>The elir approach measures effective sample size in terms of the
average curvature of the prior in relation to the Fisher
information. Informally this corresponds to the average peakiness
of the prior in relation to the information content of a single
observation. The elir approach is the only ESS which fulfills
predictive consistency. The predictive consistency of the ESS
requires that the ESS of a prior is consistent when considering an
averaged posterior ESS of additional data distributed according to
the predictive distribution of the prior. The expectation of the
posterior ESS is taken wrt to the prior predictive distribution and
the averaged posterior ESS corresponds to the sum of the prior ESS
and the number of forward simulated data items. The elir approach
results in ESS estimates which are neither conservative nor liberal
whereas the moments method yields conservative and the morita
method liberal results. See the example section for a demonstration
of predictive consistency.</p>
<p>For the moments method the mean and standard deviation of the
mixture are calculated and then approximated by the conjugate
distribution with the same mean and standard deviation. For
conjugate distributions, the ESS is well defined. See the examples
for a step-wise calculation in the beta mixture case.</p>
<p>The Morita method used here evaluates the mixture prior at the mode
instead of the mean as proposed originally by Morita. The method
may lead to very optimistic ESS values, especially if the mixture
contains many components. The calculation of the Morita approach
here follows the approach presented in Neuenschwander B. et all
(2019) which avoids the need for a minimization and does not
restrict the ESS to be an integer.</p>
<p>The arguments <code>sigma</code> and <code>family</code> are specific for
normal mixture densities. These specify the sampling standard
deviation for a <code>gaussian</code> family (the default) while also
allowing to consider the ESS of standard one-parameter exponential
families, i.e. <code>binomial</code> or <code>poisson</code>. The function
supports non-gaussian families with unit dispersion only.</p>
    </div>
    <div class="section level2">
    <h2 id="methods-by-class-">Methods (by class)<a class="anchor" aria-label="anchor" href="#methods-by-class-"></a></h2>

<ul><li><p><code>ess(betaMix)</code>: ESS for beta mixtures.</p></li>
<li><p><code>ess(gammaMix)</code>: ESS for gamma mixtures.</p></li>
<li><p><code>ess(normMix)</code>: ESS for normal mixtures.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="supported-conjugate-prior-likelihood-pairs">Supported Conjugate Prior-Likelihood Pairs<a class="anchor" aria-label="anchor" href="#supported-conjugate-prior-likelihood-pairs"></a></h2>



<table class="table table"><tr><td><strong>Prior/Posterior</strong></td><td><strong>Likelihood</strong></td><td><strong>Predictive</strong></td><td><strong>Summaries</strong></td></tr><tr><td>Beta</td><td>Binomial</td><td>Beta-Binomial</td><td><code>n</code>, <code>r</code></td></tr><tr><td>Normal</td><td>Normal (<em>fixed \(\sigma\)</em>)</td><td>Normal</td><td><code>n</code>, <code>m</code>, <code>se</code></td></tr><tr><td>Gamma</td><td>Poisson</td><td>Gamma-Poisson</td><td><code>n</code>, <code>m</code></td></tr><tr><td>Gamma</td><td>Exponential</td><td>Gamma-Exp (<em>not supported</em>)</td><td><code>n</code>, <code>m</code></td></tr></table></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Morita S, Thall PF, Mueller P.  Determining the
effective sample size of a parametric prior.  <em>Biometrics</em>
2008;64(2):595-602.</p>
<p>Neuenschwander B., Weber S., Schmidli H., O’Hagan
A. (2020). Predictively consistent prior effective sample
sizes. <em>Biometrics</em>, 76(2),
578–587. https://doi.org/10.1111/biom.13252</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Conjugate Beta example</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixbeta.html">mixbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">prior</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="va">b</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beta mixture example</span></span></span>
<span class="r-in"><span><span class="va">bmix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixbeta.html">mixbeta</a></span><span class="op">(</span>rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">10</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">bmix</span>, <span class="st">"elir"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.65152</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">bmix</span>, <span class="st">"moment"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.161034</span>
<span class="r-in"><span><span class="co"># moments method is equivalent to</span></span></span>
<span class="r-in"><span><span class="co"># first calculate moments</span></span></span>
<span class="r-in"><span><span class="va">bmix_sum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">bmix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># then calculate a and b of a matching beta</span></span></span>
<span class="r-in"><span><span class="va">ab_matched</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixbeta.html">ms2beta</a></span><span class="op">(</span><span class="va">bmix_sum</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span>, <span class="va">bmix_sum</span><span class="op">[</span><span class="st">"sd"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># finally take the sum of a and b which are equivalent</span></span></span>
<span class="r-in"><span><span class="co"># to number of responders/non-responders respectivley</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ab_matched</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">bmix</span>, method <span class="op">=</span> <span class="st">"morita"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.487603</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># One may also calculate the ESS on the logit scale, which</span></span></span>
<span class="r-in"><span><span class="co"># gives slightly different results due to the parameter</span></span></span>
<span class="r-in"><span><span class="co"># transformation, e.g.:</span></span></span>
<span class="r-in"><span><span class="va">prior_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">5</span> <span class="op">/</span> <span class="fl">15</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">5</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">prior_logit</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 21.78289</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bmix_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span>rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">10</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">bmix_logit</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.12276</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predictive consistency of elir</span></span></span>
<span class="r-in"><span><span class="va">n_forward</span> <span class="op">&lt;-</span> <span class="fl">1E1</span></span></span>
<span class="r-in"><span><span class="va">bmixPred</span> <span class="op">&lt;-</span> <span class="fu"><a href="preddist.html">preddist</a></span><span class="op">(</span><span class="va">bmix</span>, n <span class="op">=</span> <span class="va">n_forward</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="mix.html">rmix</a></span><span class="op">(</span><span class="va">bmixPred</span>, <span class="fl">1E2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use more samples here for greater accuracy, e.g.</span></span></span>
<span class="r-in"><span><span class="co"># pred_samp &lt;- rmix(bmixPred, 1E3)</span></span></span>
<span class="r-in"><span><span class="va">pred_ess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">pred_samp</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="fu">ess</span><span class="op">(</span><span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">bmix</span>, r <span class="op">=</span> <span class="va">r</span>, n <span class="op">=</span> <span class="va">n_forward</span><span class="op">)</span>, <span class="st">"elir"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">bmix</span>, <span class="st">"elir"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.65152</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pred_ess</span><span class="op">)</span> <span class="op">-</span> <span class="va">n_forward</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.071933</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Normal mixture example</span></span></span>
<span class="r-in"><span><span class="va">nmix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span>rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">2</span><span class="op">)</span>, inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">nmix</span>, <span class="st">"elir"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10.82796</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">nmix</span>, <span class="st">"moment"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.163265</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the reference scale determines the ESS</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mixnorm.html">sigma</a></span><span class="op">(</span><span class="va">nmix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">nmix</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 43.31185</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># we may also interpret normal mixtures as densities assigned to</span></span></span>
<span class="r-in"><span><span class="co"># parameters of a logit transformed response rate of a binomial</span></span></span>
<span class="r-in"><span><span class="va">nmix_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="lodds.html">logit</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">nmix_logit</span>, family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15.17836</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gamma mixture example</span></span></span>
<span class="r-in"><span><span class="va">gmix</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixgamma.html">mixgamma</a></span><span class="op">(</span>rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">20</span>, <span class="fl">4</span><span class="op">)</span>, inf <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">50</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">gmix</span><span class="op">)</span> <span class="co">## interpreted as appropriate for a Poisson likelihood (default)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 7.159378</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="likelihood.html">likelihood</a></span><span class="op">(</span><span class="va">gmix</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"exp"</span></span></span>
<span class="r-in"><span><span class="fu">ess</span><span class="op">(</span><span class="va">gmix</span><span class="op">)</span> <span class="co">## interpreted as appropriate for an exponential likelihood</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 34.93388</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

