<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Decision Function for 2 Sample Designs — decision2S • RBesT</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Decision Function for 2 Sample Designs — decision2S"><meta name="description" content="The function sets up a 2 sample one-sided decision function with an
arbitrary number of conditions on the difference distribution."><meta property="og:description" content="The function sets up a 2 sample one-sided decision function with an
arbitrary number of conditions on the difference distribution."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Decision Function for 2 Sample Designs</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/R/decision2S.R" class="external-link"><code>R/decision2S.R</code></a></small>
      <div class="d-none name"><code>decision2S.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function sets up a 2 sample one-sided decision function with an
arbitrary number of conditions on the difference distribution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">decision2S</span><span class="op">(</span></span>
<span>  pc <span class="op">=</span> <span class="fl">0.975</span>,</span>
<span>  qc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"identity"</span>, <span class="st">"logit"</span>, <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">oc2Sdecision</span><span class="op">(</span></span>
<span>  pc <span class="op">=</span> <span class="fl">0.975</span>,</span>
<span>  qc <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"identity"</span>, <span class="st">"logit"</span>, <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pc">pc<a class="anchor" aria-label="anchor" href="#arg-pc"></a></dt>
<dd><p>Vector of critical cumulative probabilities of the
difference distribution.</p></dd>


<dt id="arg-qc">qc<a class="anchor" aria-label="anchor" href="#arg-qc"></a></dt>
<dd><p>Vector of respective critical values of the difference
distribution. Must match the length of <code>pc</code>.</p></dd>


<dt id="arg-lower-tail">lower.tail<a class="anchor" aria-label="anchor" href="#arg-lower-tail"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), probabilities
are \(P(X \leq x)\), otherwise, \(P(X &gt; x)\).</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Enables application of a link function prior to
evaluating the difference distribution. Can take one of the values
<code>identity</code> (default), <code>logit</code> or <code>log</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The function returns a decision function which takes three
arguments. The first and second argument are expected to be mixture
(posterior) distributions from which the difference distribution is
formed and all conditions are tested. The third argument determines
if the function acts as an indicator function or if the function
returns the distance from the decision boundary for each condition
in log-space. That is, the distance is 0 at the decision boundary,
negative for a 0 decision and positive for a 1 decision.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function creates a one-sided decision function on the
basis of the difference distribution in a 2 sample situation. To
support double criterion designs, see <em>Neuenschwander et al.,
2010</em>, an arbitrary number of criterions can be given. The decision
function demands that the probability mass below the critical value
<code>qc</code> of the difference \(\theta_1 - \theta_2\) is at least
<code>pc</code>. Hence, for <code>lower.tail=TRUE</code> condition \(i\) is
equivalent to</p>
<p>$$P(\theta_1 - \theta_2 \leq q_{c,i}) &gt; p_{c,i}$$</p>
<p>and the decision function is implemented as indicator function
using the heavy-side step function \(H(x)\) which is \(0\) for
\(x \leq 0\) and \(1\) for \(x &gt; 0\). As all conditions must
be met, the final indicator function returns</p>
<p>$$\Pi_i H_i(P(\theta_1 - \theta_2 \leq q_{c,i}) - p_{c,i} ),$$</p>
<p>which is \(1\) if all conditions are met and \(0\)
otherwise. For <code>lower.tail=FALSE</code> differences must be greater
than the given quantiles <code>qc</code>.</p>
<p>Note that whenever a <code>link</code> other than <code>identity</code> is
requested, then the underlying densities are first transformed
using the link function and then the probabilties for the
differences are calculated in the transformed space. Hence, for a
binary endpoint the default <code>identity</code> link will calculate
risk differences, the <code>logit</code> link will lead to decisions
based on the differences in <code>logit</code>s corresponding to a
criterion based on the log-odds. The <code>log</code> link will evaluate
ratios instead of absolute differences which could be useful for a
binary endpoint or counting rates. The respective critical
quantiles <code>qc</code> must be given on the transformed scale.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>

<ul><li><p><code>oc2Sdecision()</code>: Deprecated old function name. Please use
<code>decision2S</code> instead.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Gsponer T, Gerber F, Bornkamp B, Ohlssen D,
Vandemeulebroecke M, Schmidli H.A practical guide to Bayesian group
sequential designs. <em>Pharm. Stat.</em>. 2014; 13: 71-80</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other design2S:
<code><a href="decision2S_boundary.html">decision2S_boundary</a>()</code>,
<code><a href="oc2S.html">oc2S</a>()</code>,
<code><a href="pos2S.html">pos2S</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see Gsponer et al., 2010</span></span></span>
<span class="r-in"><span><span class="va">priorT</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0.001</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">88</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">priorP</span> <span class="op">&lt;-</span> <span class="fu"><a href="mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">49</span>, <span class="fl">20</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fl">88</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the success criteria is for delta which are larger than some</span></span></span>
<span class="r-in"><span><span class="co"># threshold value which is why we set lower.tail=FALSE</span></span></span>
<span class="r-in"><span><span class="va">successCrit</span> <span class="op">&lt;-</span> <span class="fu">decision2S</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># the futility criterion acts in the opposite direction</span></span></span>
<span class="r-in"><span><span class="va">futilityCrit</span> <span class="op">&lt;-</span> <span class="fu">decision2S</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">successCrit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 sample decision function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditions for acceptance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(theta1 - theta2 &gt; 0) &gt; 0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(theta1 - theta2 &gt; 50) &gt; 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link: identity </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">futilityCrit</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 sample decision function</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conditions for acceptance:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P(theta1 - theta2 &lt;= 40) &gt; 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link: identity </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># consider decision for specific outcomes</span></span></span>
<span class="r-in"><span><span class="va">postP_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">priorP</span>, n <span class="op">=</span> <span class="fl">10</span>, m <span class="op">=</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 88</span>
<span class="r-in"><span><span class="va">postT_interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="va">priorT</span>, n <span class="op">=</span> <span class="fl">20</span>, m <span class="op">=</span> <span class="op">-</span><span class="fl">80</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using default prior reference scale 88</span>
<span class="r-in"><span><span class="fu">futilityCrit</span><span class="op">(</span><span class="va">postP_interim</span>, <span class="va">postT_interim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span><span class="fu">successCrit</span><span class="op">(</span><span class="va">postP_interim</span>, <span class="va">postT_interim</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Binary endpoint with double criterion decision on log-odds scale</span></span></span>
<span class="r-in"><span><span class="co"># 95% certain positive difference and an odds ratio of 2 at least</span></span></span>
<span class="r-in"><span><span class="va">decL2</span> <span class="op">&lt;-</span> <span class="fu">decision2S</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span>, link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 95% certain positive difference and an odds ratio of 3 at least</span></span></span>
<span class="r-in"><span><span class="va">decL3</span> <span class="op">&lt;-</span> <span class="fu">decision2S</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span>, link <span class="op">=</span> <span class="st">"logit"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data scenario</span></span></span>
<span class="r-in"><span><span class="va">post1</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="fu"><a href="mixbeta.html">mixbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">40</span>, r <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">post2</span> <span class="op">&lt;-</span> <span class="fu"><a href="postmix.html">postmix</a></span><span class="op">(</span><span class="fu"><a href="mixbeta.html">mixbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">40</span>, r <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># positive outcome and a median odds ratio of at least 2 ...</span></span></span>
<span class="r-in"><span><span class="fu">decL2</span><span class="op">(</span><span class="va">post2</span>, <span class="va">post1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="co"># ... but not more than 3</span></span></span>
<span class="r-in"><span><span class="fu">decL3</span><span class="op">(</span><span class="va">post2</span>, <span class="va">post1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

