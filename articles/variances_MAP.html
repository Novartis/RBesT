<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Meta-Analytic-Predictive Priors for Variances • RBesT</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Meta-Analytic-Predictive Priors for Variances">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Meta-Analytic-Predictive Priors for Variances</h1>
                        <h4 data-toc-skip class="author">Sebastian
Weber</h4>
            
            <h4 data-toc-skip class="date">2025-05-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/vignettes/articles/variances_MAP.Rmd" class="external-link"><code>vignettes/articles/variances_MAP.Rmd</code></a></small>
      <div class="d-none name"><code>variances_MAP.Rmd</code></div>
    </div>

    
    
<p>Applying the meta-analytic-predictive (MAP) prior approach to
historical data on variances has been suggested in [1]. The utility is a
better informed planning of future trials which use a normal endpoint.
For these reliable information on the sampling standard deviation is
crucial for planning the trial.</p>
<p>Under a normal sampling distribution the (standard) unbiased variance
estimator for a sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">y_j</annotation></semantics></math>
of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>n</mi><mi>j</mi></msub><annotation encoding="application/x-tex">n_j</annotation></semantics></math>
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>s</mi><mi>j</mi><mn>2</mn></msubsup><mo>=</mo><mfrac><mn>1</mn><mrow><msub><mi>n</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>j</mi></msub></munderover><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mrow><mi>j</mi><mo>,</mo><mi>i</mi></mrow></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">‾</mo></mover><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo>,</mo></mrow><annotation encoding="application/x-tex"> s^2_j = \frac{1}{n_j-1} \sum_{i=1}^{n_j} (y_{j,i} - \bar{y}_j)^2, </annotation></semantics></math></p>
<p>which follows a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mi>ν</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_\nu</annotation></semantics></math>
distribution with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ν</mi><mi>j</mi></msub><mo>=</mo><msub><mi>n</mi><mi>j</mi></msub><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\nu_j = n_j-1</annotation></semantics></math>
degrees of freedom. The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>χ</mi><mi>ν</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\chi^2_\nu</annotation></semantics></math>
can be rewritten as a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
distribution</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>s</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="false" form="prefix">|</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>j</mi></msub><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mn>2</mn><mo>,</mo><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mspace width="0.167em"></mspace><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> s^2_j|\nu_j,\sigma_j \sim \Gamma(\nu_j/2, \nu_j/(2\,\sigma^2_j)) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo><msubsup><mi>s</mi><mi>j</mi><mn>2</mn></msubsup><mspace width="0.167em"></mspace><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mn>2</mn><mo stretchy="false" form="prefix">|</mo><msub><mi>ν</mi><mi>j</mi></msub><mo>,</mo><msub><mi>σ</mi><mi>j</mi></msub><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mn>2</mn><mo>,</mo><mn>1</mn><mi>/</mi><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex"> \Leftrightarrow s^2_j \, \nu_j /2 |\nu_j,\sigma_j \sim \Gamma(\nu_j/2, 1/\sigma^2_j), </annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\sigma_j</annotation></semantics></math>
is the (unknown) sampling standard deviation for the data
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>y</mi><mi>j</mi></msub><annotation encoding="application/x-tex">y_j</annotation></semantics></math>.</p>
<p>While this is not directly supported in <code>RBesT</code>, a normal
approximation of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
transformed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
variate can be applied. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
transforming a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(\alpha,\beta)</annotation></semantics></math>
variate it’s moment and variance can analytically be shown to be (see
[2], for example)</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> E[\log(X)] = \psi(\alpha) - \log(\beta)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> Var[\log(X)] = \psi^{(1)}(\alpha).</annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi(x)</annotation></semantics></math>
is the digamma function and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi^{(1)}(x)</annotation></semantics></math>
is the polygamma function of order 1 (second derivative of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
function).</p>
<p>Thus, by approximating the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
transformed
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
distribution with a normal approximation, we can apply <code>gMAP</code>
as if we were using a normal endpoint. Specifically, we apply the
transform
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>j</mi></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>s</mi><mi>j</mi><mn>2</mn></msubsup><mspace width="0.167em"></mspace><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ν</mi><mi>j</mi></msub><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_j=\log(s^2_j
\, \nu_j /2) - \psi(\nu_j/2)</annotation></semantics></math> such that
the meta-analytic model directly considers
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>σ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\log \sigma_j</annotation></semantics></math>
as random variate. The normal approximation becomes more accurate, the
larger the degrees of freedom are. The section at the bottom of this
vignette discusses this approximation accuracy and concludes that
independent of the true
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
value for 10 observations the approxmation is useful and a very good one
for more than 20 observations.</p>
<p>In the following we reanalyze the main example of reference [1] which
is shown in table 2:</p>
<table class="table">
<thead><tr class="header">
<th align="right">study</th>
<th align="right">sd</th>
<th align="right">df</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">12.11</td>
<td align="right">597</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">10.97</td>
<td align="right">60</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">10.94</td>
<td align="right">548</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">9.41</td>
<td align="right">307</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10.97</td>
<td align="right">906</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">10.95</td>
<td align="right">903</td>
</tr>
</tbody>
</table>
<p>Using the above equations (and using plug-in estimates for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>σ</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\sigma_j</annotation></semantics></math>)
this translates into an approximate normal distribution for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
variance as:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">hdata</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">df</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">alpha</span> <span class="op">/</span> <span class="va">sd</span><span class="op">^</span><span class="fl">2</span>,</span>
<span>  logvar_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sd</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">alpha</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">digamma</a></span><span class="op">(</span><span class="va">alpha</span><span class="op">)</span>,</span>
<span>  logvar_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">psigamma</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">study</th>
<th align="right">sd</th>
<th align="right">df</th>
<th align="right">alpha</th>
<th align="right">beta</th>
<th align="right">logvar_mean</th>
<th align="right">logvar_var</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">12.11</td>
<td align="right">597</td>
<td align="right">298.5</td>
<td align="right">2.0354</td>
<td align="right">4.9897</td>
<td align="right">0.0034</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">10.97</td>
<td align="right">60</td>
<td align="right">30.0</td>
<td align="right">0.2493</td>
<td align="right">4.8071</td>
<td align="right">0.0339</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">10.94</td>
<td align="right">548</td>
<td align="right">274.0</td>
<td align="right">2.2894</td>
<td align="right">4.7867</td>
<td align="right">0.0037</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">9.41</td>
<td align="right">307</td>
<td align="right">153.5</td>
<td align="right">1.7335</td>
<td align="right">4.4868</td>
<td align="right">0.0065</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">10.97</td>
<td align="right">906</td>
<td align="right">453.0</td>
<td align="right">3.7643</td>
<td align="right">4.7914</td>
<td align="right">0.0022</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">10.95</td>
<td align="right">903</td>
<td align="right">451.5</td>
<td align="right">3.7656</td>
<td align="right">4.7878</td>
<td align="right">0.0022</td>
</tr>
</tbody>
</table>
<p>In order to run the MAP analysis a prior for the heterogeniety
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
and the intercept
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is needed. In reference [3] it is demonstrated that the (approximate)
sampling standard deviation of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
variance is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msqrt><mn>2</mn></msqrt><annotation encoding="application/x-tex">\sqrt{2}</annotation></semantics></math>.
Thus, a <code>HalfNormal(0,sqrt(2)/2)</code> is a very conservative
choice for the between-study heterogeniety parameter. A less
conservative choice is <code>HalfNormal(0,sqrt(2)/4)</code>, which gives
very similar results in this case. For the intercept
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
a very wide prior is used with a standard deviation of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>100</mn><annotation encoding="application/x-tex">100</annotation></semantics></math>
which is in line with reference [1]:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gMAP.html">gMAP</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">logvar_mean</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">logvar_var</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">study</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hdata</span>,</span>
<span>  tau.dist <span class="op">=</span> <span class="st">"HalfNormal"</span>, tau.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>  beta.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">100</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">map_mc</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized Meta Analytic Predictive Prior Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  gMAP(formula = cbind(logvar_mean, sqrt(logvar_var)) ~ 1 | study, </span></span>
<span><span class="co">##     data = hdata, tau.dist = "HalfNormal", tau.prior = sqrt(2)/2, </span></span>
<span><span class="co">##     beta.prior = cbind(4.8, 100))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Exchangeability tau strata: 1 </span></span>
<span><span class="co">## Prediction tau stratum    : 1 </span></span>
<span><span class="co">## Maximal Rhat              : 1 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Between-trial heterogeneity of tau prediction stratum</span></span>
<span><span class="co">##   mean     sd   2.5%    50%  97.5% </span></span>
<span><span class="co">## 0.2050 0.1040 0.0781 0.1830 0.4720 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MAP Prior MCMC sample</span></span>
<span><span class="co">##  mean    sd  2.5%   50% 97.5% </span></span>
<span><span class="co">## 4.780 0.256 4.240 4.780 5.270</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">map_mc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Heterogeneity parameter tau per stratum:</span></span>
<span><span class="co">##         mean    sd   2.5%   50% 97.5%</span></span>
<span><span class="co">## tau[1] 0.205 0.104 0.0781 0.183 0.472</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Regression coefficients:</span></span>
<span><span class="co">##             mean    sd 2.5%  50% 97.5%</span></span>
<span><span class="co">## (Intercept) 4.78 0.101 4.57 4.78  4.97</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Mean estimate MCMC sample:</span></span>
<span><span class="co">##            mean    sd 2.5%  50% 97.5%</span></span>
<span><span class="co">## theta_resp 4.78 0.101 4.57 4.78  4.97</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MAP Prior MCMC sample:</span></span>
<span><span class="co">##                 mean    sd 2.5%  50% 97.5%</span></span>
<span><span class="co">## theta_resp_pred 4.78 0.256 4.24 4.78  5.27</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map_mc</span><span class="op">)</span><span class="op">$</span><span class="va">forest_model</span></span></code></pre></div>
<p><img src="variances_MAP_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>In reference [1] the correct
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
likelihood is used in contrast to the approximate normal approach above.
Still, the results match very close, even for the outer quantiles.</p>
<div class="section level2">
<h2 id="map-prior-for-the-sampling-standard-deviation">MAP prior for the sampling standard deviation<a class="anchor" aria-label="anchor" href="#map-prior-for-the-sampling-standard-deviation"></a>
</h2>
<p>While the MAP analysis is performed for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
variance, we are actually interested in the MAP of the respective
sampling standard deviation. Since the sampling standard deviation is a
strictly positive quantity it is suitable to approximate the MCMC
posterior of the MAP prior using a mixture of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Γ</mi><annotation encoding="application/x-tex">\Gamma</annotation></semantics></math>
variates, which can be done using <code>RBesT</code> as:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mc_post</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">map_mc</span><span class="op">)</span></span>
<span><span class="va">sd_trans</span> <span class="op">&lt;-</span> <span class="fu">compose</span><span class="op">(</span><span class="va">sqrt</span>, <span class="va">exp</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html" class="external-link">mcmc_intervals</a></span><span class="op">(</span><span class="va">map_mc_post</span>, regex_pars <span class="op">=</span> <span class="st">"theta"</span>, transformation <span class="op">=</span> <span class="va">sd_trans</span><span class="op">)</span></span></code></pre></div>
<p><img src="variances_MAP_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_sigma_mc</span> <span class="op">&lt;-</span> <span class="fu">sd_trans</span><span class="op">(</span><span class="va">map_mc_post</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"theta_pred"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">map_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/automixfit.html">automixfit</a></span><span class="op">(</span><span class="va">map_sigma_mc</span>, type <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map_sigma</span><span class="op">)</span><span class="op">$</span><span class="va">mix</span></span></code></pre></div>
<p><img src="variances_MAP_files/figure-html/unnamed-chunk-8-2.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 95% interval MAP for the sampling standard deviation</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">map_sigma</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      mean        sd      2.5%     50.0%     97.5% </span></span>
<span><span class="co">## 10.980236  1.401089  8.283373 10.921528 14.063679</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="normal-approximation-of-a-loggamma-variate">Normal approximation of a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mi>Γ</mi></mrow><annotation encoding="application/x-tex">\log\Gamma</annotation></semantics></math>
variate<a class="anchor" aria-label="anchor" href="#normal-approximation-of-a-loggamma-variate"></a>
</h2>
<p>For a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(y|\alpha, \beta)</annotation></semantics></math>
variate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
which is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>log</mo><annotation encoding="application/x-tex">\log</annotation></semantics></math>
transformed,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">z = \log(y)</annotation></semantics></math>,
we have by the law of transformations for univariate densities:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> y|\alpha,\beta \sim \Gamma(\alpha,\beta) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mi>y</mi><mo>=</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> p(z) = p(y) \, y = p(\exp(z)) \, \exp(z) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>∼</mo><mo>log</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> z|\alpha,\beta \sim \log\Gamma(\alpha,\beta)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="prefix">|</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>∼</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Leftrightarrow \exp(z)|\alpha,\beta \sim \Gamma(\alpha,\beta) \, \exp(z) </annotation></semantics></math></p>
<p>The first and second moment of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>z</mi><annotation encoding="application/x-tex">z</annotation></semantics></math>
is then
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> E[z] = \psi(\alpha) - \log(\beta)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mi>a</mi><mi>r</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>z</mi><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><msup><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> Var[z] = \psi^{(1)}(\alpha).</annotation></semantics></math></p>
<p>A short simulation demonstrates the above results:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gamma_dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixgamma.html">mixgamma</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">18</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## logGamma density</span></span>
<span><span class="va">dlogGamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">z</span>, <span class="va">a</span>, <span class="va">b</span>, <span class="va">log</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">log</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span><span class="op">)</span> <span class="op">*</span> <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">dgamma</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">a</span>, <span class="va">b</span>, log <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> <span class="va">z</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">gamma_dist</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">gamma_dist</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">digamma</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">b</span><span class="op">)</span></span>
<span><span class="va">v</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">psigamma</a></span><span class="op">(</span><span class="va">a</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## compare simulated histogram of log transformed Gamma variates to</span></span>
<span><span class="co">## analytic density and approximate normal</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mix.html">rmix</a></span><span class="op">(</span><span class="va">gamma_dist</span>, <span class="fl">1E5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-distributions.html" class="external-link">mcmc_hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>logGamma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span><span class="op">)</span>, freq <span class="op">=</span> <span class="cn">FALSE</span>, binwidth <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, linetype <span class="op">=</span> <span class="st">"LogGamma"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dlogGamma</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">a</span>, b <span class="op">=</span> <span class="va">b</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_function.html" class="external-link">stat_function</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, linetype <span class="op">=</span> <span class="st">"NormalApprox"</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                fun <span class="op">=</span> <span class="va">dnorm</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="va">m</span>, sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="variances_MAP_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We see that for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ν</mi><mo>=</mo><mn>9</mn></mrow><annotation encoding="application/x-tex">\nu=9</annotation></semantics></math>
only, the approximation with a normal density is reasonable. However, by
comparing as a function of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ν</mi><annotation encoding="application/x-tex">\nu</annotation></semantics></math>
the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2.5</mn><annotation encoding="application/x-tex">2.5</annotation></semantics></math>%,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>50</mn><annotation encoding="application/x-tex">50</annotation></semantics></math>%
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>97.5</mn><annotation encoding="application/x-tex">97.5</annotation></semantics></math>%
quantiles of the correct distribution with the respective approximate
distribution we can assess the adequatness of the approximation. The
respective R code is accessible via the vignette overview page while
here the graphical result is presented for two different
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
values:</p>
<p><img src="variances_MAP_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"><img src="variances_MAP_files/figure-html/unnamed-chunk-10-2.png" width="100%" style="display: block; margin: auto;"><img src="variances_MAP_files/figure-html/unnamed-chunk-10-3.png" width="100%" style="display: block; margin: auto;"><img src="variances_MAP_files/figure-html/unnamed-chunk-10-4.png" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h3>
<p>Many thanks to Ping Chen and Simon Wandel for pointing out an issue
with the transformation as used earlier in this vignette.</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>[1] Schmidli, H., et. al, Comp. Stat. and Data Analysis, 2017,
113:100-110<br>
[2] <a href="https://en.wikipedia.org/wiki/Gamma_distribution#Logarithmic_expectation_and_variance" class="external-link uri">https://en.wikipedia.org/wiki/Gamma_distribution#Logarithmic_expectation_and_variance</a><br>
[3] Gelman A, et. al, Bayesian Data Analysis. Third edit., 2014.,
Chapter 4, p. 84</p>
</div>
<div class="section level3">
<h3 id="r-session-info">R Session Info<a class="anchor" aria-label="anchor" href="#r-session-info"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] bayesplot_1.12.0 purrr_1.0.4      dplyr_1.1.4      ggplot2_3.5.2   </span></span>
<span><span class="co">## [5] knitr_1.50       RBesT_1.8-2     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tensorA_0.36.2.1     sass_0.4.10          generics_0.1.4      </span></span>
<span><span class="co">##  [4] stringi_1.8.7        digest_0.6.37        magrittr_2.0.3      </span></span>
<span><span class="co">##  [7] evaluate_1.0.3       grid_4.5.0           RColorBrewer_1.1-3  </span></span>
<span><span class="co">## [10] mvtnorm_1.3-3        fastmap_1.2.0        plyr_1.8.9          </span></span>
<span><span class="co">## [13] jsonlite_2.0.0       pkgbuild_1.4.7       backports_1.5.0     </span></span>
<span><span class="co">## [16] Formula_1.2-5        gridExtra_2.3        QuickJSR_1.7.0      </span></span>
<span><span class="co">## [19] scales_1.4.0         codetools_0.2-20     textshaping_1.0.1   </span></span>
<span><span class="co">## [22] jquerylib_0.1.4      abind_1.4-8          cli_3.6.5           </span></span>
<span><span class="co">## [25] rlang_1.1.6          withr_3.0.2          cachem_1.1.0        </span></span>
<span><span class="co">## [28] yaml_2.3.10          StanHeaders_2.32.10  parallel_4.5.0      </span></span>
<span><span class="co">## [31] tools_4.5.0          rstan_2.32.7         inline_0.3.21       </span></span>
<span><span class="co">## [34] reshape2_1.4.4       rstantools_2.4.0     checkmate_2.3.2     </span></span>
<span><span class="co">## [37] assertthat_0.2.1     posterior_1.6.1      vctrs_0.6.5         </span></span>
<span><span class="co">## [40] R6_2.6.1             matrixStats_1.5.0    stats4_4.5.0        </span></span>
<span><span class="co">## [43] lifecycle_1.0.4      stringr_1.5.1        fs_1.6.6            </span></span>
<span><span class="co">## [46] htmlwidgets_1.6.4    ragg_1.4.0           pkgconfig_2.0.3     </span></span>
<span><span class="co">## [49] desc_1.4.3           pkgdown_2.1.2        RcppParallel_5.1.10 </span></span>
<span><span class="co">## [52] pillar_1.10.2        bslib_0.9.0          gtable_0.3.6        </span></span>
<span><span class="co">## [55] loo_2.8.0            glue_1.8.0           Rcpp_1.0.14         </span></span>
<span><span class="co">## [58] systemfonts_1.2.3    xfun_0.52            tibble_3.2.1        </span></span>
<span><span class="co">## [61] tidyselect_1.2.1     farver_2.1.2         htmltools_0.5.8.1   </span></span>
<span><span class="co">## [64] labeling_0.4.3       rmarkdown_2.29       compiler_4.5.0      </span></span>
<span><span class="co">## [67] distributional_0.5.0</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
