<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Customizing RBesT plots • RBesT</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Customizing RBesT plots">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Customizing RBesT plots</h1>
                        <h4 data-toc-skip class="author">Baldur
Magnusson</h4>
            
            <h4 data-toc-skip class="date">2025-04-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/vignettes/articles/customizing_plots.Rmd" class="external-link"><code>vignettes/articles/customizing_plots.Rmd</code></a></small>
      <div class="d-none name"><code>customizing_plots.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to work with the forest plot provided
by the <code>RBesT</code> package. We show how to modify the default
plot and, for advanced users, how to extract data from a ggplot object
to create a new plot from scratch. Finally we recreate plots from a case
study presented in the training materials.</p>
<p>For more general information on plotting in R, we recommend the
following resources:</p>
<ul>
<li>
<a href="https://CRAN.R-project.org/package=bayesplot" class="external-link">bayesplot</a>
- library on which the <code>RBesT</code> plotting functionality is
built</li>
<li>
<a href="https://ggplot2.tidyverse.org/reference/" class="external-link">ggplot2</a> -
powerful library for graphics in R</li>
<li>
<a href="http://www.cookbook-r.com/Graphs/" class="external-link">R Cookbook - Graphs</a>
- general reference for R and graphics in R</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/RBesT/">RBesT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/bayesplot/" class="external-link">bayesplot</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## This is bayesplot version 1.12.0</span></span></code></pre>
<pre><code><span><span class="co">## - Online documentation and vignettes at mc-stan.org/bayesplot</span></span></code></pre>
<pre><code><span><span class="co">## - bayesplot theme set to bayesplot::theme_default()</span></span></code></pre>
<pre><code><span><span class="co">##    * Does _not_ affect other ggplot2 plots</span></span></code></pre>
<pre><code><span><span class="co">##    * See ?bayesplot_theme_set for details on theme setting</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Default settings for bayesplot</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/theme_default.html" class="external-link">theme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load example gMAP object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">546346</span><span class="op">)</span></span>
<span><span class="va">map_crohn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gMAP.html">gMAP</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">y.se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">study</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">crohn</span>, y.se <span class="op">=</span> <span class="fl">88</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">n</span>,</span>
<span>  tau.dist <span class="op">=</span> <span class="st">"HalfNormal"</span>, tau.prior <span class="op">=</span> <span class="fl">44</span>,</span>
<span>  beta.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">88</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">map_crohn</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized Meta Analytic Predictive Prior Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  gMAP(formula = cbind(y, y.se) ~ 1 | study, family = gaussian, </span></span>
<span><span class="co">##     data = transform(crohn, y.se = 88/sqrt(n)), weights = n, </span></span>
<span><span class="co">##     tau.dist = "HalfNormal", tau.prior = 44, beta.prior = cbind(0, </span></span>
<span><span class="co">##         88))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Exchangeability tau strata: 1 </span></span>
<span><span class="co">## Prediction tau stratum    : 1 </span></span>
<span><span class="co">## Maximal Rhat              : 1 </span></span>
<span><span class="co">## Estimated reference scale : 88 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Between-trial heterogeneity of tau prediction stratum</span></span>
<span><span class="co">##  mean    sd  2.5%   50% 97.5% </span></span>
<span><span class="co">## 14.50  9.67  1.30 12.60 38.30 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MAP Prior MCMC sample</span></span>
<span><span class="co">##  mean    sd  2.5%   50% 97.5% </span></span>
<span><span class="co">## -50.5  19.4 -94.3 -49.0 -10.7</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="forest-plot">Forest plot<a class="anchor" aria-label="anchor" href="#forest-plot"></a>
</h2>
<p>The default forest plot is a “standard” forest plot with the
Meta-Analytic-Predictive (MAP) prior additionally summarized in the
bottom row:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-4-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can also include the model-based estimates for each study, and add
a legend to explain the different linetypes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span>, model <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html" class="external-link">legend_move</a></span><span class="op">(</span><span class="st">"right"</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-5-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can modify the color scheme as follows (refer to
<code><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">help(color_scheme_set)</a></code> for a full list of themes):</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># preview a color scheme</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_view</a></span><span class="op">(</span><span class="st">"mix-blue-red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-6-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># and now let's use it</span></span>
<span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"mix-blue-red"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-6-2.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"gray"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-6-3.png" width="100%" style="display: block; margin: auto;"></p>
<p>The point size can be modified and the vertical line removed:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-colors.html" class="external-link">color_scheme_set</a></span><span class="op">(</span><span class="st">"blue"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="presentation-ready-plots">Presentation-ready plots<a class="anchor" aria-label="anchor" href="#presentation-ready-plots"></a>
</h3>
<p>If a plot is to be used for a presentation or in a document such as
the study protocol, it is recommended to use sufficiently large font
sizes (e.g. about as large as the fonts on the same slide or in the same
document) and that elements of the plot are clearly visible. Here we
show a few simple statements that can be used for this purpose.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># adjust the base font size</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme_get.html" class="external-link">theme_set</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/theme_default.html" class="external-link">theme_default</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span>, model <span class="op">=</span> <span class="st">"both"</span>, est <span class="op">=</span> <span class="st">"MAP"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html" class="external-link">legend_move</a></span><span class="op">(</span><span class="st">"right"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Forest plot"</span>, subtitle <span class="op">=</span> <span class="st">"Results of Meta-Analytic-Predictive (MAP) analysis"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Plot shows point estimates (posterior medians) with 95% intervals"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-8-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We also recommend saving plots explicitly with the
<code>ggsave</code> function, which allows control (and hence
consistency) of image size. Note that the font size will be enforced in
the requested size; a small image with large font size may result in too
little space for the plot itself. The image is sized according to the
golden cut
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϕ</mi><mo>=</mo><mfrac><mrow><mn>1</mn><mo>+</mo><msqrt><mn>5</mn></msqrt></mrow><mn>2</mn></mfrac><mo>≈</mo><mn>1.62</mn></mrow><annotation encoding="application/x-tex">\phi=\frac{1+\sqrt5}{2} \approx 1.62</annotation></semantics></math>)
which is perceived as a pleasing axis ratio. Png is the recommended
image file type for presentations and study documents.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"plot1.png"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1.62</span> <span class="op">*</span> <span class="fl">2.78</span>, height <span class="op">=</span> <span class="fl">2.78</span>, unit <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span> <span class="co"># too small for the chosen font size</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="st">"plot2.png"</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/last_plot.html" class="external-link">last_plot</a></span><span class="op">(</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">1.62</span> <span class="op">*</span> <span class="fl">5.56</span>, height <span class="op">=</span> <span class="fl">5.56</span>, unit <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span> <span class="co"># fits a single ppt slide quite well</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-topics">Advanced topics<a class="anchor" aria-label="anchor" href="#advanced-topics"></a>
</h2>
<div class="section level3">
<h3 id="extract-data-from-a-ggplot-object">Extract data from a <code>ggplot</code> object<a class="anchor" aria-label="anchor" href="#extract-data-from-a-ggplot-object"></a>
</h3>
<p>In some situations, desired modifications to a plot provided by
<code>RBesT</code> may not be possible given the returned
<code>ggplot</code> object. If a truly tailored plot is desired, the
user must extract the data from this object and create a graph from
scratch using <code>ggplot</code> functions. Recall the original forest
plot:</p>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Suppose we wish to use different symbols for the meta/stratified
point estimates and a different linestyle for the vertical line. A
tailored plot can be created as follows.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract the data from the returned object</span></span>
<span><span class="va">fp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/forest_plot.html">forest_plot</a></span><span class="op">(</span><span class="va">map_crohn</span><span class="op">)</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fp_data</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                 mean  sem median  low    up    study      model</span></span>
<span><span class="co">## Gastr06          -51 10.2    -51  -71 -30.9  Gastr06 stratified</span></span>
<span><span class="co">## AIMed07          -49  6.8    -49  -62 -35.6  AIMed07 stratified</span></span>
<span><span class="co">## NEJM07           -36  4.9    -36  -46 -26.5   NEJM07 stratified</span></span>
<span><span class="co">## Gastr01a         -47 19.7    -47  -86  -8.4 Gastr01a stratified</span></span>
<span><span class="co">## APhTh04          -90 17.6    -90 -124 -55.5  APhTh04 stratified</span></span>
<span><span class="co">## Gastr01b         -54 11.6    -54  -77 -31.4 Gastr01b stratified</span></span>
<span><span class="co">## theta_resp_pred  -50 19.4    -49  -94 -10.7      MAP       meta</span></span>
<span><span class="co">## theta_resp       -50  8.6    -49  -69 -34.2     Mean       meta</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Use a two-component map mixture to compute the vertical line location</span></span>
<span><span class="va">map_mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixfit.html">mixfit</a></span><span class="op">(</span><span class="va">map_crohn</span>, Nc <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co"># Finally compose a ggplot call for the desired graph</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">fp_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">study</span>, y <span class="op">=</span> <span class="va">median</span>, ymin <span class="op">=</span> <span class="va">low</span>, ymax <span class="op">=</span> <span class="va">up</span>, linetype <span class="op">=</span> <span class="va">model</span>, shape <span class="op">=</span> <span class="va">model</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_pointrange</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.7</span>, position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="../reference/mix.html">qmix</a></span><span class="op">(</span><span class="va">map_mix</span>, <span class="fl">0.5</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"None"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">""</span>, y <span class="op">=</span> <span class="st">"Response"</span>, title <span class="op">=</span> <span class="st">"Modified forest plot"</span><span class="op">)</span></span></code></pre></div>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="design-plots-a-clinical-trial">Design plots a clinical trial<a class="anchor" aria-label="anchor" href="#design-plots-a-clinical-trial"></a>
</h3>
<p>Here we show how to create outcome and operating characteristic plots
for a clinical trial comparing a developmental drug against placebo. The
primary endpoint is binary (with event probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>)
and we use an informative prior for the placebo arm event rate. The
experimental drug is believed to lower the event rate, and the criteria
for study outcome are hence as follows:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Criterion 1:</mtext><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>t</mi><mi>r</mi><mi>t</mi></mrow></msub><mi>/</mi><msub><mi>p</mi><mrow><mi>p</mi><mi>b</mi><mi>o</mi></mrow></msub><mo>&lt;</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>&gt;</mo><mn>0.9</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Criterion 2:</mtext><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mrow><mi>t</mi><mi>r</mi><mi>t</mi></mrow></msub><mi>/</mi><msub><mi>p</mi><mrow><mi>p</mi><mi>b</mi><mi>o</mi></mrow></msub><mo>&lt;</mo><mn>0.5</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mo>&gt;</mo><mn>0.5</mn></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\textrm{Criterion 1:}  \Pr(p_{trt} / p_{pbo} &lt; 1) &amp;&gt; 0.9\\
\textrm{Criterion 2:}  \Pr(p_{trt} / p_{pbo} &lt; 0.5) &amp;&gt; 0.5
\end{align*}
</annotation></semantics></math></p>
<p>The outcome is success (GO) if both criteria are satisfied, futility
(STOP) if neither is satisfied, and indeterminate if only one or the
other is satisfied.</p>
<p>We now create a plot that shows the study conclusion, given any
combination of outcomes on the two treatment arms.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define prior distributions</span></span>
<span><span class="va">prior_pbo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixbeta.html">mixbeta</a></span><span class="op">(</span>inf1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.60</span>, <span class="fl">19</span>, <span class="fl">29</span><span class="op">)</span>, inf2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.30</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, rob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">prior_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixbeta.html">mixbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Study sample size</span></span>
<span><span class="va">n_trt</span> <span class="op">&lt;-</span> <span class="fl">50</span></span>
<span><span class="va">n_pbo</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co"># Create decision rules and designs to represent success and futility</span></span>
<span><span class="va">success</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decision2S.html">decision2S</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.90</span>, <span class="fl">0.50</span><span class="op">)</span>, qc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span>, link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="va">futility</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decision2S.html">decision2S</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.10</span>, <span class="fl">0.50</span><span class="op">)</span>, qc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.50</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span>, link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span>
<span><span class="va">design_suc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">prior_trt</span>, <span class="va">prior_pbo</span>, <span class="va">n_trt</span>, <span class="va">n_pbo</span>, <span class="va">success</span><span class="op">)</span></span>
<span><span class="va">design_fut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">prior_trt</span>, <span class="va">prior_pbo</span>, <span class="va">n_trt</span>, <span class="va">n_pbo</span>, <span class="va">futility</span><span class="op">)</span></span>
<span><span class="va">crit_suc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decision2S_boundary.html">decision2S_boundary</a></span><span class="op">(</span><span class="va">prior_trt</span>, <span class="va">prior_pbo</span>, <span class="va">n_trt</span>, <span class="va">n_pbo</span>, <span class="va">success</span><span class="op">)</span></span>
<span><span class="va">crit_fut</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decision2S_boundary.html">decision2S_boundary</a></span><span class="op">(</span><span class="va">prior_trt</span>, <span class="va">prior_pbo</span>, <span class="va">n_trt</span>, <span class="va">n_pbo</span>, <span class="va">futility</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame that holds the outcomes for y1 (treatment) that define success and futility,</span></span>
<span><span class="co"># conditional on the number of events on y2 (placebo)</span></span>
<span><span class="va">outcomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n_pbo</span><span class="op">)</span>, suc <span class="op">=</span> <span class="fu">crit_suc</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n_pbo</span><span class="op">)</span>, fut <span class="op">=</span> <span class="fu">crit_fut</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">n_pbo</span><span class="op">)</span>, max <span class="op">=</span> <span class="va">n_trt</span><span class="op">)</span></span>
<span><span class="va">outcomes</span><span class="op">$</span><span class="va">suc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">suc</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">suc</span><span class="op">)</span><span class="op">)</span> <span class="co"># don't allow negative number of events</span></span>
<span></span>
<span><span class="co"># Finally put it all together in a plot.</span></span>
<span><span class="va">o</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># offset</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">outcomes</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y2</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="va">o</span>, ymax <span class="op">=</span> <span class="va">suc</span> <span class="op">+</span> <span class="va">o</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span>, colour <span class="op">=</span> <span class="st">"green"</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">suc</span> <span class="op">+</span> <span class="va">o</span>, ymax <span class="op">=</span> <span class="va">fut</span> <span class="op">+</span> <span class="va">o</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_linerange</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">fut</span> <span class="op">+</span> <span class="va">o</span>, ymax <span class="op">=</span> <span class="va">max</span> <span class="op">+</span> <span class="va">o</span><span class="op">)</span>, colour <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">14</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">36</span>, <span class="fl">8</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"STOP"</span>, <span class="st">"GO"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_pbo</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_trt</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Events on placebo"</span>, y <span class="op">=</span> <span class="st">"Events on treatment"</span>, title <span class="op">=</span> <span class="st">"Study outcomes"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="external-link">coord_flip</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>We can also use the design functions that were already derived
(<code>design_suc</code> and <code>design_fut</code>) to compute
operating characteristics.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the grid of true event rates for which to evaluate OC</span></span>
<span><span class="va">p_trt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, length <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">p_pbo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.35</span>, <span class="fl">0.40</span>, <span class="fl">0.45</span>, <span class="fl">0.50</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Loop through the values for placebo and compute outcome probabilities</span></span>
<span><span class="va">oc_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">p_pbo</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p_go</span> <span class="op">&lt;-</span> <span class="fu">design_suc</span><span class="op">(</span><span class="va">p_trt</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">p_stop</span> <span class="op">&lt;-</span> <span class="fu">design_fut</span><span class="op">(</span><span class="va">p_trt</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">p_trt</span>, p_pbo <span class="op">=</span> <span class="va">x</span>, Go <span class="op">=</span> <span class="va">p_go</span>, Stop <span class="op">=</span> <span class="va">p_stop</span>, Indeterminate <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p_go</span> <span class="op">-</span> <span class="va">p_stop</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co"># The above returns a list, so we bind the elements together into one data frame</span></span>
<span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">oc_list</span><span class="op">)</span></span>
<span><span class="co"># And convert from wide to long format</span></span>
<span><span class="va">oc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/gather.html" class="external-link">gather</a></span><span class="op">(</span><span class="va">oc</span>, <span class="st">"Outcome"</span>, <span class="st">"Probability"</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">oc</span><span class="op">$</span><span class="va">facet_text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"True placebo rate = "</span>, <span class="va">oc</span><span class="op">$</span><span class="va">p_pbo</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally we are ready to plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">oc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">p_trt</span>, y <span class="op">=</span> <span class="va">Probability</span>, colour <span class="op">=</span> <span class="va">Outcome</span>, linetype <span class="op">=</span> <span class="va">Outcome</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">facet_text</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Outcome"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_linetype.html" class="external-link">scale_linetype</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.8</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"True event rate for treatment"</span>, y <span class="op">=</span> <span class="st">"Probability"</span>, title <span class="op">=</span> <span class="st">"Operating Characteristics"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: The `guide` argument in `scale_*()` cannot be `FALSE`. This was deprecated in</span></span>
<span><span class="co">## ggplot2 3.3.4.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use "none" instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="customizing_plots_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] bayesplot_1.12.0 tidyr_1.3.1      dplyr_1.1.4      ggplot2_3.5.2   </span></span>
<span><span class="co">## [5] knitr_1.50       RBesT_1.8-2     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.10         generics_0.1.3      digest_0.6.37      </span></span>
<span><span class="co">##  [4] magrittr_2.0.3      evaluate_1.0.3      grid_4.5.0         </span></span>
<span><span class="co">##  [7] RColorBrewer_1.1-3  mvtnorm_1.3-3       fastmap_1.2.0      </span></span>
<span><span class="co">## [10] jsonlite_2.0.0      pkgbuild_1.4.7      backports_1.5.0    </span></span>
<span><span class="co">## [13] Formula_1.2-5       gridExtra_2.3       purrr_1.0.4        </span></span>
<span><span class="co">## [16] QuickJSR_1.7.0      scales_1.4.0        codetools_0.2-20   </span></span>
<span><span class="co">## [19] textshaping_1.0.0   jquerylib_0.1.4     abind_1.4-8        </span></span>
<span><span class="co">## [22] cli_3.6.5           crayon_1.5.3        rlang_1.1.6        </span></span>
<span><span class="co">## [25] withr_3.0.2         cachem_1.1.0        yaml_2.3.10        </span></span>
<span><span class="co">## [28] StanHeaders_2.32.10 parallel_4.5.0      tools_4.5.0        </span></span>
<span><span class="co">## [31] rstan_2.32.7        inline_0.3.21       rstantools_2.4.0   </span></span>
<span><span class="co">## [34] checkmate_2.3.2     assertthat_0.2.1    vctrs_0.6.5        </span></span>
<span><span class="co">## [37] R6_2.6.1            matrixStats_1.5.0   stats4_4.5.0       </span></span>
<span><span class="co">## [40] lifecycle_1.0.4     fs_1.6.6            htmlwidgets_1.6.4  </span></span>
<span><span class="co">## [43] ragg_1.4.0          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">## [46] pkgdown_2.1.1       RcppParallel_5.1.10 pillar_1.10.2      </span></span>
<span><span class="co">## [49] bslib_0.9.0         gtable_0.3.6        loo_2.8.0          </span></span>
<span><span class="co">## [52] glue_1.8.0          Rcpp_1.0.14         systemfonts_1.2.2  </span></span>
<span><span class="co">## [55] xfun_0.52           tibble_3.2.1        tidyselect_1.2.1   </span></span>
<span><span class="co">## [58] farver_2.1.2        htmltools_0.5.8.1   labeling_0.4.3     </span></span>
<span><span class="co">## [61] rmarkdown_2.29      compiler_4.5.0</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
