<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>RBesT for a Normal Endpoint • RBesT</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RBesT for a Normal Endpoint">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RBesT</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/customizing_plots.html">Customizing RBesT plots</a></li>
    <li><a class="dropdown-item" href="../articles/introduction_normal.html">RBesT for a Normal Endpoint</a></li>
    <li><a class="dropdown-item" href="../articles/introduction.html">Getting started with RBesT (binary)</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_codata.html">Probability of Success with Co-Data</a></li>
    <li><a class="dropdown-item" href="../articles/PoS_interim.html">Probability of Success at an Interim Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/variances_MAP.html">Meta-Analytic-Predictive Priors for Variances</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/RBesT/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RBesT for a Normal Endpoint</h1>
                        <h4 data-toc-skip class="author">Yue Li</h4>
            
            <h4 data-toc-skip class="date">2025-05-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/RBesT/blob/main/vignettes/articles/introduction_normal.Rmd" class="external-link"><code>vignettes/articles/introduction_normal.Rmd</code></a></small>
      <div class="d-none name"><code>introduction_normal.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The R Bayesian evidence synthesis Tools (RBesT) have been created to
facilitate the use of historical information in clinical trials. Once
relevant historical information has been identified, RBesT supports the
derivation of informative priors via the Meta-Analytic-Predictive (MAP)
approach [1], the evaluation of the trial’s operating characteristics,
and the data analysis with the actual trial data. RBesT has been
developed for endpoints from a number of well known distributions. Here
we consider an example for a normally distributed response variable.</p>
</div>
<div class="section level2">
<h2 id="trial-design-with-historical-control-data">Trial Design with Historical Control Data<a class="anchor" aria-label="anchor" href="#trial-design-with-historical-control-data"></a>
</h2>
<div class="section level3">
<h3 id="historical-data">Historical Data<a class="anchor" aria-label="anchor" href="#historical-data"></a>
</h3>
<p>Let’s look at the Crohn’s disease example data [2] (data-set
<code>crohn</code> in RBesT). The primary endpoint is the change from
baseline in Crohn’s Disease Activity Index (CDAI), which is assumed to
be normally distributed. Note that for CDAI, an improved outcome
corresponds to a negative change from baseline.</p>
<p>First from historical studies we get the estimated standard deviation
of the response variable as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
= 88, which is used to obtain the standard errors of the effect
estimates.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">crohn</span></span>
<span><span class="va">crohn_sigma</span> <span class="op">&lt;-</span> <span class="fl">88</span></span>
<span><span class="va">dat</span><span class="op">$</span><span class="va">y.se</span> <span class="op">&lt;-</span> <span class="va">crohn_sigma</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">n</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">study</th>
<th align="right">n</th>
<th align="right">y</th>
<th align="right">y.se</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gastr06</td>
<td align="right">74</td>
<td align="right">-51</td>
<td align="right">10.23</td>
</tr>
<tr class="even">
<td align="left">AIMed07</td>
<td align="right">166</td>
<td align="right">-49</td>
<td align="right">6.83</td>
</tr>
<tr class="odd">
<td align="left">NEJM07</td>
<td align="right">328</td>
<td align="right">-36</td>
<td align="right">4.86</td>
</tr>
<tr class="even">
<td align="left">Gastr01a</td>
<td align="right">20</td>
<td align="right">-47</td>
<td align="right">19.68</td>
</tr>
<tr class="odd">
<td align="left">APhTh04</td>
<td align="right">25</td>
<td align="right">-90</td>
<td align="right">17.60</td>
</tr>
<tr class="even">
<td align="left">Gastr01b</td>
<td align="right">58</td>
<td align="right">-54</td>
<td align="right">11.55</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="derivation-of-map-prior">Derivation of MAP Prior<a class="anchor" aria-label="anchor" href="#derivation-of-map-prior"></a>
</h3>
<p>The MAP prior can be derived with the function
<strong><code>gMAP</code></strong>. The between-trial heterogeneity
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
governs how much information will be shared from the historical trials
into the design and analysis of the future trials. In the normal case
with a known sampling standard deviation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>,
the amount of borrowing from historical data depends on the ratio
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>τ</mi><mi>/</mi><mi>σ</mi></mrow><annotation encoding="application/x-tex">\tau/\sigma</annotation></semantics></math>.
A conservative choice for the prior on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
is a <strong><code>HalfNormal(0,</code></strong>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\sigma/2</annotation></semantics></math><strong><code>)</code></strong>
distribution. For the prior on the intercept we recommend a
“unit-information” prior [3] which is set to a precision corresponding
to a single observation and centered here at no change from baseline.
Please refer to the help page <strong><code><a href="../reference/gMAP.html">?gMAP</a></code></strong> for
detailed information. The <strong><code>set.seed</code></strong>
function is used to make the results exactly reproducible.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/RBesT/">RBesT</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">689654</span><span class="op">)</span></span>
<span><span class="va">map_mcmc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gMAP.html">gMAP</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">y.se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">study</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">n</span>, data <span class="op">=</span> <span class="va">dat</span>,</span>
<span>  family <span class="op">=</span> <span class="va">gaussian</span>,</span>
<span>  beta.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">crohn_sigma</span><span class="op">)</span>,</span>
<span>  tau.dist <span class="op">=</span> <span class="st">"HalfNormal"</span>, tau.prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">crohn_sigma</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">map_mcmc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Generalized Meta Analytic Predictive Prior Analysis</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Call:  gMAP(formula = cbind(y, y.se) ~ 1 | study, family = gaussian, </span></span>
<span><span class="co">##     data = dat, weights = n, tau.dist = "HalfNormal", tau.prior = cbind(0, </span></span>
<span><span class="co">##         crohn_sigma/2), beta.prior = cbind(0, crohn_sigma))</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Exchangeability tau strata: 1 </span></span>
<span><span class="co">## Prediction tau stratum    : 1 </span></span>
<span><span class="co">## Maximal Rhat              : 1 </span></span>
<span><span class="co">## Estimated reference scale : 88 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Between-trial heterogeneity of tau prediction stratum</span></span>
<span><span class="co">##  mean    sd  2.5%   50% 97.5% </span></span>
<span><span class="co">## 14.30  9.38  1.54 12.20 36.80 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## MAP Prior MCMC sample</span></span>
<span><span class="co">##  mean    sd  2.5%   50% 97.5% </span></span>
<span><span class="co">## -49.7  18.6 -88.4 -48.7 -12.3</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## a graphical representation is also available</span></span>
<span><span class="va">pl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map_mcmc</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## a number of plots are immediately defined</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pl</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "densityThetaStar"     "densityThetaStarLink" "forest_model"</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## forest plot with model estimates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pl</span><span class="op">$</span><span class="va">forest_model</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_normal_files/figure-html/gMAP-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="approximation-of-map-prior-using-a-mixture-distribution">Approximation of MAP Prior using a Mixture Distribution<a class="anchor" aria-label="anchor" href="#approximation-of-map-prior-using-a-mixture-distribution"></a>
</h3>
<p>Next, the MCMC MAP prior from the previous section is converted to a
parametric representation with the
<strong><code>automixfit</code></strong> function. This function fits a
parametric mixture representation using expectation-maximization (EM).
The number of mixture components is chosen automatically using AIC. One
can also specify the number of components for the mixture via
<strong><code>mixfit</code></strong> function and compare with the
<strong><code>automixfit</code></strong> outcome.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/automixfit.html">automixfit</a></span><span class="op">(</span><span class="va">map_mcmc</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## EM for Normal Mixture Model</span></span>
<span><span class="co">## Log-Likelihood = -17021.66</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Univariate normal mixture</span></span>
<span><span class="co">## Reference scale: 88</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##   comp1       comp2       comp3      </span></span>
<span><span class="co">## w   0.4366963   0.4324896   0.1308141</span></span>
<span><span class="co">## m -47.7396255 -51.3051003 -51.1267753</span></span>
<span><span class="co">## s   8.4310808  18.1462655  36.1496171</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## check accuracy of mixture fit</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">$</span><span class="va">mix</span></span></code></pre></div>
<p><img src="introduction_normal_files/figure-html/EM-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="effective-sample-size-ess">Effective Sample Size (ESS)<a class="anchor" aria-label="anchor" href="#effective-sample-size-ess"></a>
</h3>
<p>The main advantage of using historical information is the possibility
to reduce the number of control patients, as the informative prior is
effectively equivalent to a certain number of control patients. This is
called the effective sample size (ESS) and can be calculated in RBesT
with the <strong><code>ess</code></strong> function.</p>
<p>In the study protocol of this Crohn’s disease data example, the very
conservative moment-based ESS of 20 was used to reduce the planned
sample size of the control group.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/ess.html">ess</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">)</span> <span class="co">## default elir method</span></span></code></pre></div>
<pre><code><span><span class="co">## Using default prior reference scale 88</span></span></code></pre>
<pre><code><span><span class="co">## [1] 37</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/ess.html">ess</a></span><span class="op">(</span><span class="va">map</span>, method <span class="op">=</span> <span class="st">"morita"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using default prior reference scale 88</span></span></code></pre>
<pre><code><span><span class="co">## [1] 78</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/ess.html">ess</a></span><span class="op">(</span><span class="va">map</span>, method <span class="op">=</span> <span class="st">"moment"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using default prior reference scale 88</span></span></code></pre>
<pre><code><span><span class="co">## [1] 22</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="robustification-of-map-prior">Robustification of MAP Prior<a class="anchor" aria-label="anchor" href="#robustification-of-map-prior"></a>
</h3>
<p>We recommend robustifying [5] the prior with the
<strong><code>robustify</code></strong> function, which protects against
type-I error inflation in presence of prior-data conflict. For the
normal case we strongly recommend explicitly choosing the mean of the
robust component. We use
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mn>50</mn></mrow><annotation encoding="application/x-tex">-50</annotation></semantics></math>
consistent with the mean of the MAP prior. Furthermore, 20% probability
is used for the additional robust (unit-information) mixture component.
The choice of such probability reflects the confidence about the
validitiy of the model assumptions, i.e. the possibility of a
non-exchangable control group to be enrolled per inclusion/exclusion
criteria in the current trial as compared to the historical control
group population. Note that robustification decreases the ESS.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## add a 20% non-informative mixture component</span></span>
<span><span class="va">map_robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robustify.html">robustify</a></span><span class="op">(</span><span class="va">map</span>, weight <span class="op">=</span> <span class="fl">0.2</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using default prior reference scale 88</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">map_robust</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Univariate normal mixture</span></span>
<span><span class="co">## Reference scale: 88</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##   comp1       comp2       comp3       robust     </span></span>
<span><span class="co">## w   0.3493570   0.3459917   0.1046513   0.2000000</span></span>
<span><span class="co">## m -47.7396255 -51.3051003 -51.1267753 -50.0000000</span></span>
<span><span class="co">## s   8.4310808  18.1462655  36.1496171  88.0000000</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="../reference/ess.html">ess</a></span><span class="op">(</span><span class="va">map_robust</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using default prior reference scale 88</span></span></code></pre>
<pre><code><span><span class="co">## [1] 27</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="operating-characteristics-of-design-options">Operating Characteristics of Design Options<a class="anchor" aria-label="anchor" href="#operating-characteristics-of-design-options"></a>
</h3>
<p>Typically, operating characteristics are required to evaluate the
proposed design or compare a few design options. RBesT requires the
input of decision rules via <strong><code>decision2S</code></strong>
function and then calculates the operating characteristics with the
<strong><code>oc2S</code></strong> function. The calculation is
expedited based on analytic expressions. In the following we compare a
few design options, which differ in the choice of the control priors and
the sample size of the control group for the planned trial. There may be
other design factors (such as the outcome standard deviation), which
should be considered when comparing design options. Such factors are not
considered here for simplicity purpose.</p>
<div class="section level4">
<h4 id="decision-rules">Decision Rules<a class="anchor" aria-label="anchor" href="#decision-rules"></a>
</h4>
<p>Consider this 2-arm design of placebo (with an informative prior)
against an experimental treatment. The dual-criterion for success is
defined as follows:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Criterion 1:</mtext></mtd><mtd columnalign="left" style="text-align: left"><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mi>a</mi><mi>c</mi><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>θ</mi><mrow><mi>p</mi><mi>b</mi><mi>o</mi></mrow></msub><mo>&lt;</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>&gt;</mo><mn>0.95</mn></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">Criterion 2:</mtext></mtd><mtd columnalign="left" style="text-align: left"><mo>Pr</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>θ</mi><mrow><mi>a</mi><mi>c</mi><mi>t</mi></mrow></msub><mo>−</mo><msub><mi>θ</mi><mrow><mi>p</mi><mi>b</mi><mi>o</mi></mrow></msub><mo>&lt;</mo><mo>−</mo><mn>50</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mo>&gt;</mo><mn>0.50</mn><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{align*}
\textrm{Criterion 1:} &amp;  \Pr(\theta_{act} - \theta_{pbo} \lt 0) &amp;&gt; 0.95 \\
\textrm{Criterion 2:} &amp; \Pr(\theta_{act} - \theta_{pbo} \lt -50) &amp;&gt; 0.50.
\end{align*}
</annotation></semantics></math></p>
<p>Equivalently, the second criterion requires that the posterior median
difference exceeds -50. The dual-criteria account for statistical
significance as well as clinical relevance. Note that a negative change
from baseline in CDAI corresponds to improvement.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## dual decision criteria</span></span>
<span><span class="co">## pay attention to "lower.tail" argument and the order of active and pbo</span></span>
<span><span class="va">poc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/decision2S.html">decision2S</a></span><span class="op">(</span>pc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.5</span><span class="op">)</span>, qc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">50</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">poc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## 2 sample decision function</span></span>
<span><span class="co">## Conditions for acceptance:</span></span>
<span><span class="co">## P(theta1 - theta2 &lt;= 0) &gt; 0.95</span></span>
<span><span class="co">## P(theta1 - theta2 &lt;= -50) &gt; 0.5</span></span>
<span><span class="co">## Link: identity</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="design-options">Design Options<a class="anchor" aria-label="anchor" href="#design-options"></a>
</h4>
<p>For the active group we use the same weakly informative
(unit-information) prior as used in the robustification step of the MAP
prior. Also, we set up the few design options with different choices of
control prior and different sizes of control group.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## set up prior for active group</span></span>
<span><span class="va">weak_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixnorm.html">mixnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="va">crohn_sigma</span>, param <span class="op">=</span> <span class="st">"mn"</span><span class="op">)</span></span>
<span><span class="va">n_act</span> <span class="op">&lt;-</span> <span class="fl">40</span></span>
<span><span class="va">n_pbo</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co">## four designs</span></span>
<span><span class="co">## "b" means a balanced design, 1:1</span></span>
<span><span class="co">## "ub" means 40 in active and 20 in placebo</span></span>
<span><span class="va">design_noprior_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">weak_prior</span>, <span class="va">weak_prior</span>, <span class="va">n_act</span>, <span class="va">n_act</span>, <span class="va">poc</span>,</span>
<span>  sigma1 <span class="op">=</span> <span class="va">crohn_sigma</span>, sigma2 <span class="op">=</span> <span class="va">crohn_sigma</span></span>
<span><span class="op">)</span></span>
<span><span class="va">design_noprior_ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">weak_prior</span>, <span class="va">weak_prior</span>, <span class="va">n_act</span>, <span class="va">n_pbo</span>, <span class="va">poc</span>,</span>
<span>  sigma1 <span class="op">=</span> <span class="va">crohn_sigma</span>, sigma2 <span class="op">=</span> <span class="va">crohn_sigma</span></span>
<span><span class="op">)</span></span>
<span><span class="va">design_nonrob_ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">weak_prior</span>, <span class="va">map</span>, <span class="va">n_act</span>, <span class="va">n_pbo</span>, <span class="va">poc</span>,</span>
<span>  sigma1 <span class="op">=</span> <span class="va">crohn_sigma</span>, sigma2 <span class="op">=</span> <span class="va">crohn_sigma</span></span>
<span><span class="op">)</span></span>
<span><span class="va">design_rob_ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/oc2S.html">oc2S</a></span><span class="op">(</span><span class="va">weak_prior</span>, <span class="va">map_robust</span>, <span class="va">n_act</span>, <span class="va">n_pbo</span>, <span class="va">poc</span>,</span>
<span>  sigma1 <span class="op">=</span> <span class="va">crohn_sigma</span>, sigma2 <span class="op">=</span> <span class="va">crohn_sigma</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="type-i-error">Type I Error<a class="anchor" aria-label="anchor" href="#type-i-error"></a>
</h4>
<p>The type I can be increased compared to the nominal
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
level in case of a conflict between the trial data and the prior. The
robustified MAP prior can reduce the type I error inflation in this case
to a lower level.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># the range for true values</span></span>
<span><span class="va">cfb_truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">120</span>, <span class="op">-</span><span class="fl">40</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">typeI1</span> <span class="op">&lt;-</span> <span class="fu">design_noprior_b</span><span class="op">(</span><span class="va">cfb_truth</span>, <span class="va">cfb_truth</span><span class="op">)</span></span>
<span><span class="va">typeI2</span> <span class="op">&lt;-</span> <span class="fu">design_noprior_ub</span><span class="op">(</span><span class="va">cfb_truth</span>, <span class="va">cfb_truth</span><span class="op">)</span></span>
<span><span class="va">typeI3</span> <span class="op">&lt;-</span> <span class="fu">design_nonrob_ub</span><span class="op">(</span><span class="va">cfb_truth</span>, <span class="va">cfb_truth</span><span class="op">)</span></span>
<span><span class="va">typeI4</span> <span class="op">&lt;-</span> <span class="fu">design_rob_ub</span><span class="op">(</span><span class="va">cfb_truth</span>, <span class="va">cfb_truth</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ocI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth <span class="op">=</span> <span class="va">cfb_truth</span>, typeI <span class="op">=</span> <span class="va">typeI1</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:40 with non-informative priors"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth <span class="op">=</span> <span class="va">cfb_truth</span>, typeI <span class="op">=</span> <span class="va">typeI2</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with non-informative priors"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth <span class="op">=</span> <span class="va">cfb_truth</span>, typeI <span class="op">=</span> <span class="va">typeI3</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with non-robust prior for placebo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth <span class="op">=</span> <span class="va">cfb_truth</span>, typeI <span class="op">=</span> <span class="va">typeI4</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with robust prior for placebo"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ocI</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">cfb_truth</span>, <span class="va">typeI</span>, colour <span class="op">=</span> <span class="va">design</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Type I Error"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"True value of change from baseline "</span>, <span class="va">mu</span><span class="op">[</span><span class="va">act</span><span class="op">]</span> <span class="op">==</span> <span class="va">mu</span><span class="op">[</span><span class="va">pbo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Type I error"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2</span></span>
<span><span class="co">## 3.5.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use the `legend.position.inside` argument of `theme()` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="introduction_normal_files/figure-html/typeI-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="power">Power<a class="anchor" aria-label="anchor" href="#power"></a>
</h4>
<p>The power shows the gain of using an informative prior for the
control arm; i.e. 90% power is reached for smaller
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
values compared to the design with weakly informative priors for both
arms or the balanced design.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80</span>, <span class="fl">0</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">map</span><span class="op">)</span><span class="op">[</span><span class="st">"mean"</span><span class="op">]</span></span>
<span><span class="va">cfb_truth1</span> <span class="op">&lt;-</span> <span class="va">m</span> <span class="op">+</span> <span class="va">delta</span> <span class="co"># active for 1</span></span>
<span><span class="va">cfb_truth2</span> <span class="op">&lt;-</span> <span class="va">m</span> <span class="op">+</span> <span class="fl">0</span> <span class="op">*</span> <span class="va">delta</span> <span class="co"># pbo for 2</span></span>
<span></span>
<span><span class="va">power1</span> <span class="op">&lt;-</span> <span class="fu">design_noprior_b</span><span class="op">(</span><span class="va">cfb_truth1</span>, <span class="va">cfb_truth2</span><span class="op">)</span></span>
<span><span class="va">power2</span> <span class="op">&lt;-</span> <span class="fu">design_noprior_ub</span><span class="op">(</span><span class="va">cfb_truth1</span>, <span class="va">cfb_truth2</span><span class="op">)</span></span>
<span><span class="va">power3</span> <span class="op">&lt;-</span> <span class="fu">design_nonrob_ub</span><span class="op">(</span><span class="va">cfb_truth1</span>, <span class="va">cfb_truth2</span><span class="op">)</span></span>
<span><span class="va">power4</span> <span class="op">&lt;-</span> <span class="fu">design_rob_ub</span><span class="op">(</span><span class="va">cfb_truth1</span>, <span class="va">cfb_truth2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ocP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth1 <span class="op">=</span> <span class="va">cfb_truth1</span>, cfb_truth2 <span class="op">=</span> <span class="va">cfb_truth2</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>, power <span class="op">=</span> <span class="va">power1</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:40 with non-informative priors"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth1 <span class="op">=</span> <span class="va">cfb_truth1</span>, cfb_truth2 <span class="op">=</span> <span class="va">cfb_truth2</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>, power <span class="op">=</span> <span class="va">power2</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with non-informative priors"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth1 <span class="op">=</span> <span class="va">cfb_truth1</span>, cfb_truth2 <span class="op">=</span> <span class="va">cfb_truth2</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>, power <span class="op">=</span> <span class="va">power3</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with non-robust prior for placebo"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    cfb_truth1 <span class="op">=</span> <span class="va">cfb_truth1</span>, cfb_truth2 <span class="op">=</span> <span class="va">cfb_truth2</span>,</span>
<span>    delta <span class="op">=</span> <span class="va">delta</span>, power <span class="op">=</span> <span class="va">power4</span>,</span>
<span>    design <span class="op">=</span> <span class="st">"40:20 with robust prior for placebo"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">ocP</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">delta</span>, <span class="va">power</span>, colour <span class="op">=</span> <span class="va">design</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Power"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"True value of difference (act - pbo)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Power"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">80</span>, <span class="fl">0</span>, <span class="fl">20</span><span class="op">)</span>, <span class="op">-</span><span class="fl">70</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0.9</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="op">-</span><span class="fl">70</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_normal_files/figure-html/power-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="final-analysis-with-trial-data">Final Analysis with Trial Data<a class="anchor" aria-label="anchor" href="#final-analysis-with-trial-data"></a>
</h2>
<p>When the actual trial data are available, the final analysis can be
run with RBesT via the <strong><code>postmix</code></strong> function.
The real data are used for this example, where the trial data led to a
negative conclusion. However, note that
<strong><code>postmix</code></strong> assumes that the sampling standard
deviation is known and fixed. Therefore, no uncertainty in its estimate
is taken into account.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## one can either use summary data or individual data. See ?postmix.</span></span>
<span><span class="va">y.act</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">29.2</span></span>
<span><span class="va">y.act.se</span> <span class="op">&lt;-</span> <span class="fl">14.0</span></span>
<span><span class="va">n.act</span> <span class="op">&lt;-</span> <span class="fl">39</span></span>
<span></span>
<span><span class="va">y.pbo</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">63.1</span></span>
<span><span class="va">y.pbo.se</span> <span class="op">&lt;-</span> <span class="fl">13.9</span></span>
<span><span class="va">n.pbo</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span></span>
<span><span class="co">## first obtain posterior distributions</span></span>
<span><span class="va">post_act</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/postmix.html">postmix</a></span><span class="op">(</span><span class="va">weak_prior</span>, m <span class="op">=</span> <span class="va">y.act</span>, se <span class="op">=</span> <span class="va">y.act.se</span><span class="op">)</span></span>
<span><span class="va">post_pbo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/postmix.html">postmix</a></span><span class="op">(</span><span class="va">map_robust</span>, m <span class="op">=</span> <span class="va">y.pbo</span>, se <span class="op">=</span> <span class="va">y.pbo.se</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## then calculate probability for the dual criteria</span></span>
<span><span class="co">## and compare to the predefined threshold values</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixdiff.html">pmixdiff</a></span><span class="op">(</span><span class="va">post_act</span>, <span class="va">post_pbo</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06149329</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mixdiff.html">pmixdiff</a></span><span class="op">(</span><span class="va">post_act</span>, <span class="va">post_pbo</span>, <span class="op">-</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 3.795469e-06</span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">&gt;</span> <span class="fl">0.95</span> <span class="op">&amp;</span> <span class="va">p2</span> <span class="op">&gt;</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## or we can use the decision function</span></span>
<span><span class="fu">poc</span><span class="op">(</span><span class="va">post_act</span>, <span class="va">post_pbo</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0</span></span></code></pre>
<div class="section level4">
<h4 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h4>
<p>[1] Neuenschwander B et. al, <em>Clin Trials</em>. 2010;
7(1):5-18<br>
[2] Hueber W. et. al, <em>Gut</em>, 2012, 61(12):1693-1700<br>
[3] Kass RE, Wasserman L, <em>J Amer Statist Assoc</em>; 1995,
90(431):928-934.<br>
[4] Morita S. et. al, <em>Biometrics</em> 2008;64(2):595-602<br>
[5] Schmidli H. et. al, <em>Biometrics</em> 2014;70(4):1023-1032</p>
</div>
<div class="section level4">
<h4 id="r-session-info">R Session Info<a class="anchor" aria-label="anchor" href="#r-session-info"></a>
</h4>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.2 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] ggplot2_3.5.2 knitr_1.50    RBesT_1.8-2  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] tensorA_0.36.2.1     sass_0.4.10          generics_0.1.4      </span></span>
<span><span class="co">##  [4] stringi_1.8.7        digest_0.6.37        magrittr_2.0.3      </span></span>
<span><span class="co">##  [7] evaluate_1.0.3       grid_4.5.0           RColorBrewer_1.1-3  </span></span>
<span><span class="co">## [10] mvtnorm_1.3-3        fastmap_1.2.0        plyr_1.8.9          </span></span>
<span><span class="co">## [13] jsonlite_2.0.0       pkgbuild_1.4.7       backports_1.5.0     </span></span>
<span><span class="co">## [16] Formula_1.2-5        gridExtra_2.3        QuickJSR_1.7.0      </span></span>
<span><span class="co">## [19] scales_1.4.0         codetools_0.2-20     textshaping_1.0.1   </span></span>
<span><span class="co">## [22] jquerylib_0.1.4      abind_1.4-8          cli_3.6.5           </span></span>
<span><span class="co">## [25] crayon_1.5.3         rlang_1.1.6          withr_3.0.2         </span></span>
<span><span class="co">## [28] cachem_1.1.0         yaml_2.3.10          StanHeaders_2.32.10 </span></span>
<span><span class="co">## [31] parallel_4.5.0       tools_4.5.0          rstan_2.32.7        </span></span>
<span><span class="co">## [34] inline_0.3.21        reshape2_1.4.4       rstantools_2.4.0    </span></span>
<span><span class="co">## [37] checkmate_2.3.2      dplyr_1.1.4          assertthat_0.2.1    </span></span>
<span><span class="co">## [40] posterior_1.6.1      vctrs_0.6.5          R6_2.6.1            </span></span>
<span><span class="co">## [43] matrixStats_1.5.0    stats4_4.5.0         lifecycle_1.0.4     </span></span>
<span><span class="co">## [46] stringr_1.5.1        fs_1.6.6             htmlwidgets_1.6.4   </span></span>
<span><span class="co">## [49] ragg_1.4.0           pkgconfig_2.0.3      desc_1.4.3          </span></span>
<span><span class="co">## [52] pkgdown_2.1.2        RcppParallel_5.1.10  pillar_1.10.2       </span></span>
<span><span class="co">## [55] bslib_0.9.0          gtable_0.3.6         loo_2.8.0           </span></span>
<span><span class="co">## [58] glue_1.8.0           Rcpp_1.0.14          systemfonts_1.2.3   </span></span>
<span><span class="co">## [61] xfun_0.52            tibble_3.2.1         tidyselect_1.2.1    </span></span>
<span><span class="co">## [64] bayesplot_1.12.0     farver_2.1.2         htmltools_0.5.8.1   </span></span>
<span><span class="co">## [67] labeling_0.4.3       rmarkdown_2.29       compiler_4.5.0      </span></span>
<span><span class="co">## [70] distributional_0.5.0</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
